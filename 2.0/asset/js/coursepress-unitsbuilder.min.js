var CoursePress=CoursePress||{};!function(e){function t(){CoursePress.UnitBuilder=new CoursePress.Views.UnitBuilder({el:"#unit-builder"})}CoursePress.Views=CoursePress.Views||{},CoursePress.Models=CoursePress.Models||{},CoursePress.Collections=CoursePress.Collections||{},CoursePress.Helpers=CoursePress.Helpers||{},CoursePress.Helpers.Module=CoursePress.Helpers.Module||{},CoursePress.Helpers.Module.quiz=CoursePress.Helpers.Module.quiz||{},CoursePress.Helpers.Module.form=CoursePress.Helpers.Module.form||{},CoursePress.Helpers.Module.refresh_ui=function(){e.each(e(".unit-builder-modules .editor"),function(t,s){var a=e(s).attr("id");if("undefined"==typeof tinyMCE.editors[a]){var i=e("#"+a).val(),r=e(s).attr("name"),n=e(s).attr("data-height")?e(s).attr("data-height"):400;CoursePress.editor.create(s,a,r,i,!1,n)}}),e(".unit-builder-modules").hasClass("ui-accordion")&&e(".unit-builder-modules").accordion("destroy");var t=0;if(CoursePress.UnitBuilder.activeModuleRef&&CoursePress.UnitBuilder.activeModuleRef.length>0){var s=e('[data-cid="'+CoursePress.UnitBuilder.activeModuleRef+'"]')[0];t=parseInt(e(s).attr("data-order"))-1}e(".unit-builder-modules").accordion({heightStyle:"content",collapsible:!0,header:"> div > h3",active:t}).sortable({axis:"y",handle:"h3",stop:function(t,s){s.item.children("h3").triggerHandler("focusout",s);var a=e(".module-holder");e.each(a,function(t,s){var a=parseInt(e(s).attr("data-order")),i=t+1,r=e(s).attr("data-cid");e(s).attr("data-order",i),a!==i&&(CoursePress.UnitBuilder.module_collection._byId[r].set_meta("module_order",i),e(s).addClass("dirty"))}),e(this).accordion("refresh");var i=this.getElementsByClassName("wp-editor-tabs");e.each(i,function(e,t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)});var r=document.querySelectorAll('textarea[id^="post_content_"]');e.each(r,function(e,t){tinymce.execCommand("mceRemoveEditor",!0,t.id),tinymce.execCommand("mceAddEditor",!0,t.id)})}}),e(".unit-builder-tabs ul").sortable({stop:function(){var t=e(".unit-builder-tabs ul li");e.each(t,function(t,s){var a=parseInt(e(s).attr("data-order")),i=t+1,r=e(s).attr("data-cid");if(e(s).attr("data-order",i),a!==i){var n=CoursePress.UnitBuilder.unit_collection._byId[r].get("meta");n.unit_order=i,CoursePress.UnitBuilder.unit_collection._byId[r].set("meta",n),CoursePress.UnitBuilder.unit_collection._byId[r].set("flag","dirty"),e(s).addClass("dirty")}})}}),e(".button.browse-media-field").browse_media_field(),e(".unit-builder-pager ul li").removeClass("active"),e('.unit-builder-pager ul li[data-page="'+CoursePress.UnitBuilder.activePage+'"]').addClass("active"),"publish"===CoursePress.UnitBuilder.activeUnitStatus?(e("#unit-live-toggle").removeClass("off"),e("#unit-live-toggle").addClass("on"),e("#unit-live-toggle-2").removeClass("off"),e("#unit-live-toggle-2").addClass("on")):(e("#unit-live-toggle").removeClass("on"),e("#unit-live-toggle").addClass("off"),e("#unit-live-toggle-2").removeClass("on"),e("#unit-live-toggle-2").addClass("off"));var a=CoursePress.UnitBuilder.unit_collection.get(CoursePress.UnitBuilder.activeUnitRef),i=a&&a.get("user_cap")?a.get("user_cap"):{},r=i.coursepress_change_unit_status_cap;e(".coursepress-ui-toggle-switch").each(function(){var t=e(this),s=t.attr("name"),a=!0;"publish-course-toggle"===s&&(CoursePress.current_user_can("coursepress_change_status_cap")||(a=!1)),("unit-live-toggle"===s||"unit-live-toggle-2"===s)&&(r||(a=!1,t.unbind("click"))),a&&t.coursepress_ui_toggle()});var n=CoursePress.UnitBuilder.$el.find(".unit-delete-button"),o=i.coursepress_delete_course_units_cap;n[o?"show":"hide"](),1===CoursePress.UnitBuilder.totalPages?e(".unit-delete-page-button").addClass("hidden"):e(".unit-delete-page-button").removeClass("hidden"),e(".unit-builder-pager ul li[data-page]").droppable({activeClass:"page-droppable",hoverClass:"page-droppable-hover",accept:".unit-builder-modules .group",tolerance:"pointer",drop:function(t,s){var a=t.target,i=parseInt(e(a).attr("data-page")),r=CoursePress.UnitBuilder.activePage,n=s.draggable;if(r!==i){var o=e(e(n).find(".module-holder")[0]).attr("data-cid"),l=CoursePress.UnitBuilder.module_collection._byId[o].get("meta");l.module_page=i,l.module_order=l.module_order+900,CoursePress.UnitBuilder.module_collection._byId[o].set("meta",l),CoursePress.UnitBuilder.module_collection._byId[o].trigger("change",CoursePress.UnitBuilder.module_collection._byId[o]),e(n).detach()}}}),e(".dateinput").datepicker({dateFormat:"yy-mm-dd"}),e(".date").off("sync"),e(".date").on("click",function(){e(this).find(".dateinput").datepicker("show")});var l=e(".button-add-new-unit");l=l.length>0?l.position().top+e(".button-add-new-unit").innerHeight()+20:0;var u=parseFloat(e("#unit-builder .tab-content").css("min-height").replace("px",""));818>u&&(u=818,e("#unit-builder .tab-content").css("min-height",u+"px")),l>u&&e("#unit-builder .tab-content").css("min-height",l+"px"),e(".unit-builder-body .quiz-action-button").off("click"),e(".unit-builder-body .quiz-action-button").on("click",function(){var t=this,s=e(t).parents(".module-components")[0],a=e(t).parents(".module-holder")[0],i=e(s).find(".quiz-question"),r=i.length,n=e(t).attr("data-type"),o='<div class="quiz-question question-'+(r+1)+'" data-id="'+(r+1)+'" data-type="'+n+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">';o+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var l="",u='<div class="question-answer">';switch(n){case"single":var d="single-"+(r+1);l=_coursepress.unit_builder.question_type.single,u+='<div class="answer-group">',u+='<div class="answer"><input type="radio" name="'+d+'" value="" />',u+='<input class="component-radio-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',u+='<div class="answer"><input type="radio" name="'+d+'" value="" />',u+='<input class="component-radio-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',u+="</div>",u+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"multiple":l=_coursepress.unit_builder.question_type.multiple,u+='<div class="answer-group">',u+='<div class="answer"><input type="checkbox" name="" value="" />',u+='<input class="component-checkbox-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',u+='<div class="answer"><input type="checkbox" name="" value="" />',u+='<input class="component-checkbox-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',u+="</div>",u+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"short":l=_coursepress.unit_builder.question_type.short,u+='<div class="answer-group">',u+='<label data-key="label" class="wide">',u+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",u+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",u+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',u+="</label>",u+="</div>",u+="</div>";break;case"long":l=_coursepress.unit_builder.question_type.long,u+='<div class="answer-group">',u+='<label data-key="label" class="wide">',u+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",u+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",u+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',u+="</label>",u+="</div>",u+="</div>"}u+="</div>",o+='<label class="wide" data-key="label"><span class="label">'+l+":</span></label>",o+="<textarea></textarea>",o+=u,o+="</div>",e(s).append(o),CoursePress.Helpers.Module.quiz.update_meta(a),CoursePress.Helpers.Module.quiz.bind_buttons()}),CoursePress.Helpers.Module.quiz.bind_add_item(),CoursePress.Helpers.Module.form.bind_buttons(),e(".unit-builder-body .form-action-button").off("click"),e(".unit-builder-body .form-action-button").on("click",function(){var t=this,s=e(t).parents(".module-components")[0],a=e(t).parents(".module-holder")[0],i=e(s).find(".quiz-question"),r=i.length,n=e(t).attr("data-type"),o='<div class="quiz-question question-'+(r+1)+'" data-id="'+(r+1)+'" data-type="'+n+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">';o+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var l="",u='<div class="question-answer">';switch(n){case"short":l=_coursepress.unit_builder.question_type.short,u+='<div class="answer-group">',u+='<label data-key="label" class="wide">',u+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",u+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",u+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',u+="</label>",u+="</div>",u+="</div>";break;case"long":l=_coursepress.unit_builder.question_type.long,u+='<div class="answer-group">',u+='<label data-key="label" class="wide">',u+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",u+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",u+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',u+="</label>",u+="</div>",u+="</div>";break;case"selectable":var d="selectable-"+(r+1);l=_coursepress.unit_builder.question_type.selectable,u+='<div class="answer-group">',u+='<div class="answer"><input type="radio" name="'+d+'" value="" />',u+='<input class="component-select-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>',u+='<div class="answer"><input type="radio" name="'+d+'" value="" />',u+='<input class="component-select-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>',u+="</div>",u+='<a class="add-form-item">'+_coursepress.unit_builder_add_answer_label+"</a>"}u+="</div>",o+='<label class="wide" data-key="label"><span class="label">'+l+":</span></label>",o+="<textarea></textarea>",o+=u,o+="</div>",e(s).append(o),CoursePress.Helpers.Module.form.update_meta(a),CoursePress.Helpers.Module.form.bind_buttons()}),CoursePress.Helpers.Module.form.bind_buttons(),e(".module-assessable input").on("change",function(){var t=e(this),s=t.is(":checked"),a=e(t.data("target"),t.parents(".module-header").first()),i=a.find("input");i.attr("readonly",!s)}).change()},CoursePress.Helpers.Module.quiz.render_component=function(t){var s=t.get_meta("questions");if(void 0===s||s.length<=0)return"";var a="";return e.each(s,function(t,s){a+='<div class="quiz-question question-'+(t+1)+'" data-id="'+(t+1)+'" data-type="'+s.type+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">',a+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var i="",r='<div class="question-answer">';switch(s.type){case"single":i=_coursepress.unit_builder.question_type.single,r+='<div class="answer-group">',s.options.answers=s.options.answers||[],e.each(s.options.answers,function(e,a){var i=s.options.checked[e]?"checked=checked":"";r+='<div class="answer"><input type="radio" name="question'+(t+1)+'" value="" '+i+" />",r+='<input class="component-radio-answer wide" type="text" value="'+a+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>'}),r+="</div>",r+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"multiple":i=_coursepress.unit_builder.question_type.multiple,r+='<div class="answer-group">',e.each(s.options.answers,function(e,t){var a=s.options.checked[e]?"checked=checked":"";r+='<div class="answer"><input type="checkbox" name="" value="" '+a+" />",r+='<input class="component-checkbox-answer wide" type="text" value="'+t+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>'}),r+="</div>",r+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"short":break;case"long":}r+="</div>",a+='<label class="wide" data-key="label"><span class="label">'+i+":</span></label>",a+="<textarea>"+s.question+"</textarea>",a+=r,a+="</div>"}),a},CoursePress.Helpers.Module.quiz.update_meta=function(t){var s=e(t).attr("data-cid"),a={},i=CoursePress.UnitBuilder.module_collection._byId[s],r=e(t).find(".quiz-question");e.each(r,function(t,s){var i;switch(a[t]={type:e(s).attr("data-type"),question:e(s).find("textarea").val(),options:{}},a[t].type){case"single":a[t].options.answers=[],a[t].options.checked=[],i=e(s).find(".answer-group .answer"),e.each(i,function(s,i){a[t].options.answers[s]=e(i).find('[type="text"]').val(),a[t].options.checked[s]=e(i).find('[type="radio"]').is(":checked")});break;case"multiple":a[t].options.answers=[],a[t].options.checked=[],i=e(s).find(".answer-group .answer"),e.each(i,function(s,i){a[t].options.answers[s]=e(i).find('[type="text"]').val(),a[t].options.checked[s]=e(i).find('[type="checkbox"]').is(":checked")});break;case"short":break;case"long":}}),i.set_meta("questions",a),i.set("flag","dirty")},CoursePress.Helpers.Module.quiz.bind_add_item=function(){e(".quiz-question .add-quiz-item").off("click"),e(".quiz-question .add-quiz-item").on("click",function(){var t=this,s=e(t).parents(".quiz-question")[0],a=e(s).attr("data-type"),i="single"===a?"radio":"checkbox",r="single"===a?"component-radio-answer wide":"component-checkbox-answer wide",n=e(s).attr("data-type")+"-"+e(s).attr("data-id"),o='<div class="answer"><input type="'+i+'" value="" name="'+n+'"><input type="text" name="" value="" class="'+r+'"><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>';e(s).find(".answer-group").append(o),CoursePress.Helpers.Module.quiz.bind_remove_item(),CoursePress.Helpers.Module.quiz.bind_checkboxes(),CoursePress.Helpers.Module.quiz.bind_textboxes()})},CoursePress.Helpers.Module.quiz.bind_checkboxes=function(){e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').off("change"),e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').on("change",function(){var t=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.quiz.update_meta(t)})},CoursePress.Helpers.Module.quiz.bind_textboxes=function(){e('.quiz-question [type="text"], .quiz-question textarea').off("keyup"),e('.quiz-question [type="text"], .quiz-question textarea').on("keyup",function(){var t=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.quiz.update_meta(t)})},CoursePress.Helpers.Module.quiz.bind_remove_item=function(){e(".quiz-question .remove-quiz-item").off("click"),e(".quiz-question .remove-quiz-item").on("click",function(){var t=this,s=e(t).parents(".answer")[0],a=e(this).parents(".module-holder")[0];e(s).detach(),CoursePress.Helpers.Module.quiz.update_meta(a)})},CoursePress.Helpers.Module.quiz.bind_remove_question=function(){e(".quiz-question .quiz-question-remove").off("click"),e(".quiz-question .quiz-question-remove").on("click",function(){var t=this,s=e(t).parents(".quiz-question")[0],a=e(s).siblings(".quiz-question"),i=e(this).parents(".module-holder")[0];e.each(a,function(t,s){e(s).attr("class",""),e(s).addClass("quiz-question"),e(s).addClass("question-"+(t+1)),e(s).attr("data-id",t+1)}),e(s).detach(),CoursePress.Helpers.Module.quiz.update_meta(i)})},CoursePress.Helpers.Module.quiz.bind_buttons=function(){CoursePress.Helpers.Module.quiz.bind_add_item(),CoursePress.Helpers.Module.quiz.bind_remove_item(),CoursePress.Helpers.Module.quiz.bind_remove_question(),CoursePress.Helpers.Module.quiz.bind_checkboxes(),CoursePress.Helpers.Module.quiz.bind_textboxes()},CoursePress.Helpers.Module.form.render_component=function(t){var s=t.get_meta("questions");if(void 0===s||s.length<=0)return"";var a="";return e.each(s,function(t,s){a+='<div class="quiz-question question-'+(t+1)+'" data-id="'+(t+1)+'" data-type="'+s.type+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">',a+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var i="",r='<div class="question-answer">';switch(s.type){case"short":i=_coursepress.unit_builder.question_type.short,r+='<div class="answer-group">',r+='<label data-key="label" class="wide">',r+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",r+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",r+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="'+s.placeholder+'" />',r+="</label>",r+="</div>",r+="</div>";break;case"long":i=_coursepress.unit_builder.question_type.long,r+='<div class="answer-group">',r+='<label data-key="label" class="wide">',r+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",r+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",r+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="'+s.placeholder+'" />',r+="</label>",r+="</div>",r+="</div>";break;case"selectable":i=_coursepress.unit_builder.question_type.selectable,r+='<div class="answer-group">',s.options.answers=s.options.answers||[],e.each(s.options.answers,function(e,a){var i=s.options.checked[e]?"checked=checked":"";r+='<div class="answer"><input type="radio" name="question'+(t+1)+'" value="" '+i+" />",r+='<input class="component-select-answer wide" type="text" value="'+a+'" name="" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>'}),r+="</div>",r+='<a class="add-form-item">'+_coursepress.unit_builder_add_answer_label+"</a>"}r+="</div>",a+='<label class="wide" data-key="label"><span class="label">'+i+":</span></label>",a+="<textarea>"+s.question+"</textarea>",a+=r,a+="</div>"}),a},CoursePress.Helpers.Module.form.update_meta=function(t){var s=e(t).attr("data-cid"),a={},i=CoursePress.UnitBuilder.module_collection._byId[s],r=e(t).find(".quiz-question");e.each(r,function(t,s){var i;switch(a[t]={type:e(s).attr("data-type"),question:e(s).find("textarea").val(),options:{}},a[t].type){case"single":a[t].options.answers=[],a[t].options.checked=[],i=e(s).find(".answer-group .answer"),e.each(i,function(s,i){a[t].options.answers[s]=e(i).find('[type="text"]').val(),a[t].options.checked[s]=e(i).find('[type="radio"]').is(":checked")});break;case"multiple":a[t].options.answers=[],a[t].options.checked=[],i=e(s).find(".answer-group .answer"),e.each(i,function(s,i){a[t].options.answers[s]=e(i).find('[type="text"]').val(),a[t].options.checked[s]=e(i).find('[type="checkbox"]').is(":checked")});break;case"short":a[t].placeholder=e(s).find(".answer-group .placeholder input").val();break;case"long":a[t].placeholder=e(s).find(".answer-group .placeholder input").val();break;case"selectable":a[t].options.answers=[],a[t].options.checked=[],i=e(s).find(".answer-group .answer"),e.each(i,function(s,i){a[t].options.answers[s]=e(i).find('[type="text"]').val(),a[t].options.checked[s]=e(i).find('[type="radio"]').is(":checked")})}}),i.set_meta("questions",a),i.set("flag","dirty")},CoursePress.Helpers.Module.form.bind_add_item=function(){e(".quiz-question .add-form-item").off("click"),e(".quiz-question .add-form-item").on("click",function(){var t=this,s=e(t).parents(".quiz-question")[0],a=e(s).attr("data-type"),i="single"===a||"selectable"===a?"radio":"checkbox",r="single"===a?"component-radio-answer wide":"component-checkbox-answer wide";"selectable"===a&&(r="component-select-answer wide");var n=e(s).attr("data-type")+"-"+e(s).attr("data-id"),o='<div class="answer"><input type="'+i+'" value="" name="'+n+'"><input type="text" name="" value="" class="'+r+'"><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>';e(s).find(".answer-group").append(o),CoursePress.Helpers.Module.form.bind_remove_item(),CoursePress.Helpers.Module.form.bind_checkboxes(),CoursePress.Helpers.Module.form.bind_textboxes()})},CoursePress.Helpers.Module.form.bind_checkboxes=function(){e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').off("change"),e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').on("change",function(){var t=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.form.update_meta(t)})},CoursePress.Helpers.Module.form.bind_textboxes=function(){e('.quiz-question [type="text"], .quiz-question textarea').off("keyup"),e('.quiz-question [type="text"], .quiz-question textarea').on("keyup",function(){var t=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.form.update_meta(t)})},CoursePress.Helpers.Module.form.bind_remove_item=function(){e(".quiz-question .remove-form-item").off("click"),e(".quiz-question .remove-form-item").on("click",function(){var t=this,s=e(t).parents(".answer")[0],a=e(this).parents(".module-holder")[0];e(s).detach(),CoursePress.Helpers.Module.form.update_meta(a)})},CoursePress.Helpers.Module.form.bind_remove_question=function(){e(".quiz-question .quiz-question-remove").off("click"),e(".quiz-question .quiz-question-remove").on("click",function(){var t=this,s=e(t).parents(".quiz-question")[0],a=e(s).siblings(".quiz-question"),i=e(this).parents(".module-holder")[0];e.each(a,function(t,s){e(s).attr("class",""),e(s).addClass("quiz-question"),e(s).addClass("question-"+(t+1)),e(s).attr("data-id",t+1)}),e(s).detach(),CoursePress.Helpers.Module.form.update_meta(i)})},CoursePress.Helpers.Module.form.bind_buttons=function(){CoursePress.Helpers.Module.form.bind_add_item(),CoursePress.Helpers.Module.form.bind_remove_item(),CoursePress.Helpers.Module.form.bind_remove_question(),CoursePress.Helpers.Module.form.bind_checkboxes(),CoursePress.Helpers.Module.form.bind_textboxes()},CoursePress.Helpers.Module.delete_page=function(t,s,a){var i=e("#unit-builder").attr("data-nonce");CoursePress.UnitBuilder.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules_update_delete_section&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&page="+CoursePress.UnitBuilder.activePage+"&wp_nonce="+i+"&page="+a,Backbone.sync("update",CoursePress.UnitBuilder.module_collection,{success:function(t){e("#unit-builder").attr("data-nonce",t.nonce)},error:function(){}})},CoursePress.Helpers.Module.save_unit=function(t,s){e(".unit-buttons .unit-save-button").prepend('<i class="fa fa-spinner fa-spin save-progress"></i> ');var a=e("#unit-builder").attr("data-nonce"),i=e("#unit-builder").closest("form"),r=e(".component-checkbox-answer, .component-radio-answer, .component-select-answer",i);if(0<r.length){var n=[],o="";if(e.each(r,function(s,a){t=e(a),""===t.val()&&(module_title=e(".module-title .module-title-text",t.closest(".module-holder")).val(),o!==module_title&&(n.push("- "+module_title),o=module_title))}),0<n.length)return e(".save-progress").detach(),alert(_coursepress.unit_builder_form.messages.required_fields+"\n"+n.join("\n")),!1}CoursePress.UnitBuilder.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules_update&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&page="+CoursePress.UnitBuilder.activePage+"&wp_nonce="+a+"&x=1",Backbone.sync("update",CoursePress.UnitBuilder.module_collection,{success:function(t){e("#unit-builder").attr("data-nonce",t.nonce)},error:function(){}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units_update&course_id="+_coursepress.course_id+"&wp_nonce="+a,Backbone.sync("update",CoursePress.UnitBuilder.unit_collection,{success:function(t){e(".save-progress").detach(),a=t.nonce,e("#unit-builder").attr("data-nonce",a),CoursePress.UnitBuilder.unit_collection.trigger(s,CoursePress.UnitBuilder.unit_collection),CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.successfully_saved,"success")},error:function(){e(".save-progress").detach(),e(t.currentTarget).prepend('<i class="fa fa-info-circle save-progress"></i> '),CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.error_while_saving,"error")}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id,CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.saving_unit,"info")},CoursePress.Helpers.Module.unit_add_show_message=function(t,s){e(".section.unit-builder-components .notice").detach(),e(".section.unit-builder-components .description").after('<div class="notice notice-'+s+'"><p>'+t+"</p></div>"),"success"===s&&setTimeout(function(){e(".section.unit-builder-components .notice").fadeOut()},3e3)},CoursePress.Helpers.Module.unit_show_message=function(t,s){e(".unit-builder-header .unit-buttons .notice, .unit-builder-footer .unit-buttons .notice").detach(),e(".unit-builder-header .unit-buttons, .unit-builder-footer .unit-buttons").prepend('<div class="notice notice-'+s+'"><p>'+t+"</p></div>"),"success"===s&&setTimeout(function(){e(".unit-builder-header .unit-buttons .notice, .unit-builder-footer .unit-buttons .notice").fadeOut()},3e3)},CoursePress.Helpers.Module.toggle_unit_state=function(){var t=e("#unit-builder").attr("data-nonce");this.switch=function(t,s,a){"publish"===t?(e("#unit-live-toggle").removeClass("off"),e("#unit-live-toggle").addClass("on"),e("#unit-live-toggle-2").removeClass("off"),e("#unit-live-toggle-2").addClass("on")):(e("#unit-live-toggle").removeClass("on"),e("#unit-live-toggle").addClass("off"),e("#unit-live-toggle-2").removeClass("on"),e("#unit-live-toggle-2").addClass("off"));var i=CoursePress.UnitBuilder.unit_collection._byId[a].get("post_status");i!==t&&(CoursePress.UnitBuilder.unit_collection._byId[a].set("post_status",t),CoursePress.UnitBuilder.unit_collection._byId[a].trigger("change",CoursePress.UnitBuilder.unit_collection._byId[a]),e('.unit-builder-tabs [data-tab="'+s+'"]').removeClass("unit-draft"),e('.unit-builder-tabs [data-tab="'+s+'"]').removeClass("unit-live"),e('.unit-builder-tabs [data-tab="'+s+'"]').addClass("publish"===t?"unit-live":"unit-draft"))};var s=this,a=CoursePress.UnitBuilder.activeUnitID,i=CoursePress.UnitBuilder.activeUnitRef,r=CoursePress.UnitBuilder.unit_collection._byId[i].get("post_status");r="publish"===r?"draft":"publish",CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=unit_toggle&course_id="+_coursepress.course_id+"&wp_nonce="+t+"&state="+r+"&unit_id="+a,Backbone.sync("update",CoursePress.UnitBuilder.unit_collection,{success:function(t){s.switch(t.post_status,a,i),e("#unit-builder").attr("data-nonce",t.nonce),CoursePress.UnitBuilder.activeUnitStatus=t.post_status},error:function(t){s.switch(t.post_status,a,i),e("#unit-builder").attr("data-nonce",t.nonce)}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id},CoursePress.Helpers.Module.render_module=function(e,t){function l(){return'<label class="module-mandatory"><input type="checkbox" name="meta_mandatory['+e.cid+']" value="1" '+CoursePress.utility.checked(r.mandatory,1)+' /><span class="label">'+a.module_mandatory+'</span><span class="description">'+a.module_mandatory_desc+"</span></label>"}function u(){return'<label class="module-assessable"><input type="checkbox" data-target=".module-minimum-grade" name="meta_assessable['+e.cid+']" value="1" '+CoursePress.utility.checked(r.assessable,1)+' /><span class="label">'+a.module_assessable+'</span><span class="description">'+a.module_assessable_desc+"</span></label>"}function d(){return'<label class="module-use-timer"><input type="checkbox" data-target=".module-duration" name="meta_use_timer['+e.cid+']" value="1" '+CoursePress.utility.checked(r.use_timer,1)+' /><span class="label">'+a.module_use_timer+'</span><br /><span class="description">'+a.module_use_timer_desc+"</span></label>"}function c(){return'<label class="module-allow-retries"><input type="checkbox" name="meta_allow_retries['+e.cid+']" value="1" '+CoursePress.utility.checked(r.allow_retries,1)+' /><span class="label">'+a.module_allow_retries+'</span><input type="number" name="meta_retry_attempts" value="'+r.retry_attempts+'" min="0" class="small-text" /><span class="description">'+a.module_allow_retries_desc+"</span></label>"}function p(){return'<label class="module-minimum-grade"><span class="label">'+a.module_minimum_grade+'</span><input type="number" name="meta_minimum_grade" value="'+r.minimum_grade+'" min="0" max="100" class="small-text" /><span class="description">'+a.module_minimum_grade_desc+"</span></label>"}var i,r,s=_coursepress.unit_builder_module_types,a=_coursepress.unit_builder_module_labels;if(e.module_type()&&_coursepress.unit_builder_templates[e.module_type()].trim().length>0&&(r=JSON.parse(_coursepress.unit_builder_templates[e.module_type()])),void 0===r||void 0===_coursepress.unit_builder_module_types[r.type])return"";r.id=e.get("ID"),r.title=e.get("post_title"),r.duration=e.get_meta("duration"),r.type=e.module_type(),r.mode=s[r.type].mode,r.show_title=e.fix_boolean(e.get_meta("show_title")),r.mandatory=e.fix_boolean(e.get_meta("mandatory")),r.assessable=e.fix_boolean(e.get_meta("assessable")),r.minimum_grade=e.get_meta("minimum_grade",100),r.allow_retries=e.fix_boolean(e.get_meta("allow_retries")),r.retry_attempts=e.get_meta("retry_attempts",0),r.use_timer=e.fix_boolean(e.get_meta("use_timer")),r.instructor_assessable=e.fix_boolean(e.get_meta("instructor_assessable"));var n=e.get("post_excerpt");n=n&&n.length>0?n:e.get("post_content"),n=_.escape(n),r.content=n.trim(),r.order=e.get_meta("order",0),r.page=e.get_meta("page",1),r.moduletoautocorrect=_coursepress.modules_to_autocorrect,r.unit=e.get("post_parent"),i='<h3 class="module-holder-title '+r.type+'"><span class="label">'+r.title+'</span><span class="module-type">'+s[r.type].title+'</span></h3><div class="module-holder '+r.type+" mode-"+r.mode+'" data-id="'+r.id+'" data-type="'+r.type+'" data-order="'+t+'" data-cid="'+e.cid+'">';var o=r.type;if(s[r.type].body&&"hidden"!==s[r.type].body||!s[r.type].body){if(i+='<div class="module-header">',i+='<div class="module module-title"><h4 class="label">'+a.module_title+'</h4><span class="description">'+a.module_title_desc+'</span><label class="show-title"><input type="checkbox" class="show-title" name="meta_show_title['+e.cid+']" value="1" '+CoursePress.utility.checked(r.show_title,1)+' data-target=".module-title-text"/>'+a.module_show_title_desc+'</label><input class="module-title-text" type="text" name="post_title" value="'+r.title+'" /></div>',i+='<input type="hidden" name="meta_module_type" value="'+r.type+'" />',("input"===r.mode||"discussion"===r.type)&&(i+=l(),i+=u(),"input"===r.mode&&(null!=o.match(/input/)&&(i+=d()),i+=c(),i+=p())),"video"===r.type&&(i+=d(),i+=c()),i+='<div class="module module-duration"><h4 class="div">'+a.module_duration+'</h4><input type="text" name="meta_duration" value="'+r.duration+'" /></div>',"input-upload"===o&&(i+='<label class="module-assessable-2"><input type="checkbox" name="meta_instructor_assessable['+e.cid+']" value="1" '+CoursePress.utility.checked(r.instructor_assessable,1)+' /><span class="label">'+a.module_instructor_assessable+'</span><br /><span class="description">'+a.module_instructor_assessable_desc+"</span></label>"),s[r.type].excerpt&&"hidden"!==s[r.type].excerpt||!s[r.type].excerpt){var m="";
m=0===parseInt(r.id)||_.isNaN(parseInt(r.id))?"post_content_"+(new Date).getTime():"post_content_"+r.id+"_"+(new Date).getTime();var h=m,v="input"===r.mode?a.module_question:a.module_content,g="input"===r.mode?a.module_question_desc:a.module_content_desc,b=r.editor_height?'data-height="'+r.editor_height+'"':"";i+='<div class="module module-excerpt"><h4 class="label">'+v+'</h4><span class="description">'+g+'</span><textarea class="editor" name="'+m+'" id="'+h+'" '+b+">"+r.content+"</textarea></div>"}i+="</div>",i+='<div class="module module-components">'+CoursePress.Helpers.Module.render_components(e,r)+"</div>"}return i+='<div class="unit-buttons"><div class="button unit-delete-module-button"><i class="fa fa-trash-o"></i> '+a.module_delete+"</div></div>",i+="</div>"},CoursePress.Helpers.Module.render_components=function(t,s){var a="",i=_.isArray(s.components)?s.components:[],r={};return e.each(i,function(i,n){var o=n.label?n.label:"",l=n.description?n.description:"",u=n["class"]?'class="'+n["class"]+'"':"",d=i,c="module-component-"+d;a+='<div class="module module-component '+c+'"><label data-key="label" '+u+'><span class="label">'+o+'</span><span class="description">'+l+"</span></label>";var p=_.isArray(n.items)?n.items:[];e.each(p,function(i,n){var l,u,d,p,m,h,v,g,b,o=n.type?n.type:"";switch(o){case"text-input":case"number-input":var f=n.name.replace("meta_","");f=t.get_meta(f),l=n.name?' name="'+n.name+'"':"",l+=n["class"]?' class="'+n["class"]+'"':"",g=n.label?n.label:"";var w=n.label_tag?n.label_tag:"";h=n.placeholder?n.placeholder:"";var y="number-input"==o?"number":"text";g.length>1&&(a+="<"+w+">"+g+"</"+w+">"),a+='<input type="'+y+'"'+l+' value="'+f+'" placeholder="'+h+'" />';break;case"text":l=n["class"]?' class="'+n["class"]+'"':"",u=n.text?n.text:"",a+="<div"+l+">"+u+"</div>";break;case"select-select":case"radio-select":d=n.name?n.name:"",l=n["class"]?' class="'+n["class"]+'"':"",p=t.get_meta("answers"),p=p.length>0?p:n.answers,m=t.get_meta("answers_selected",parseInt(n.selected)),a+='<div class="answer-group">',e.each(p,function(e,s){_.isNaN(parseInt(m))&&(m=m===s?e:m),V=d+"_selected["+t.cid+"]",a+='<div class="answer"><input type="radio" name="'+V+'" value="'+e+'" '+CoursePress.utility.checked(parseInt(m),e)+" />",a+='<input type="text" '+l+' value="'+s+'" name="'+d+'[]" /> <span class="remove-item"></span><i class="fa fa-trash-o"></i></span></div>'}),a+="</div>",a+='<a class="add-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"checkbox-select":d=n.name?n.name:"",l=n["class"]?' class="'+n["class"]+'"':"",p=t.get_meta("answers"),p=p.length>0?p:n.answers,m=t.get_meta("answers_selected"),m=m.length>0?m:n.selected,_.isNaN(parseInt(m[0]))&&e.each(m,function(e,t){m[e]=_.indexOf(p,t)}),a+='<div class="answer-group">',e.each(p,function(e,s){var i=_.indexOf(m,e)>-1?'checked="checked"':"";V=d+"_selected["+t.cid+"][]",a+='<div class="answer"><input type="checkbox" name="'+V+'" value="'+e+'" '+i+" />",a+='<input type="text" '+l+' value="'+s+'" name="'+d+'[]" /> <span class="remove-item"><i class="fa fa-trash-o"></i></span></div>'}),a+="</div>",a+='<a class="add-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"media-caption-settings":v=n["class"]?' class="'+n["class"]+'"':"";var C=n.option_class?' class="'+n.option_class+'"':"",k=n.label?n.label:"",P=n.option_labels?n.option_labels.media:"",x=n.option_labels?n.option_labels.custom:"";h=n.placeholder?n.placeholder:"";var q=n.enable_name?n.enable_name:"",V=n.option_name?n.option_name:"",U=n.input_name?n.input_name:"",M=n.no_caption?n.no_caption:"",z=t.get_meta(q),I=t.get_meta(V),B=t.get_meta(U);q=q+"["+t.cid+"]",V=V+"["+t.cid+"]",a+="<div "+v+'><label><input type="checkbox" value="1" name="'+q+'" '+CoursePress.utility.checked(z,1)+" /><span>"+k+"</span></label><div "+C+'><label><input type="radio" value="media" name="'+V+'" '+CoursePress.utility.checked(I,"media")+" /><span>"+P+'</span></label><div class="existing">'+M+'</div><label><input type="radio" value="custom" name="'+V+'" '+CoursePress.utility.checked(I,"custom")+" /><span>"+x+'</span></label><br /><input type="text" placeholder="'+h+'" value="'+B+'" name="'+U+'" /></div></div>',r.media_url&&r.media_url.length>0&&(CoursePress.utility.attachment_by_url(r.media_url,"."+c+" .existing",M),r.media_url=null);break;case"media-browser":var H=n.media_type?n.media_type:"image",T=n["class"]?n["class"]:"";v=n.container_class?n.container_class:"";var $=n.button_text?n.button_text:"";h=n.placeholder?n.placeholder:"",d=n.name?n.name:"",b=t.get_meta(d,""),a+=CoursePress.UI.browse_media_field(d,d,{value:b,type:H,container_class:v,textbox_class:T,placeholder:h,button_text:$}),r.media_url=b;break;case"checkbox":d=n.name?n.name:"",g=n.label?n.label:"",b=t.get_meta(d,""),d=d+"["+t.cid+"]",a+='<label class="normal"><input type="checkbox" value="1" name="'+d+'" '+CoursePress.utility.checked(b,1)+" /><span>"+g+"</span></label>";break;case"action":var D=n["class"]||"",N=n.action||"",R=n.title||"",S=n.dashicon||"";a+='<div class="'+D+'" data-type="'+N+'"><a>',S&&(a+='<span class="dashicons dashicons-'+S+'"></span>'),a+="</a>",R&&(a+='<span class="element-label">'+R+"</span>"),a+="</div>";break;case"quiz":a+=CoursePress.Helpers.Module.quiz.render_component(t);break;case"form":a+=CoursePress.Helpers.Module.form.render_component(t);break;case"autocor-select":l=n.name?' name="'+n.name+'"':"",l+=n["class"]?' class="'+n["class"]+'"':"",p=s.moduletoautocorrect,p=p.length>0?p:"",question_selected=t.get_meta("question_selected"),question_selected=parseInt(question_selected),a+="<select "+l+">",e.each(p,function(e,t){s.unit===t.post_parent&&(m=question_selected===t.ID?"selected":"",a+='<option value="'+t.ID+'"'+m+">"+t.post_title+"</option>")}),a+="</select >"}}),a+="</div>"}),a},CoursePress.Views.UnitBuilder=Backbone.View.extend({initialize:function(){this.unit_collection=new CoursePress.Collections.UnitTabs,this.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id,this.unit_collection.fetch(),this.module_collection=new CoursePress.Collections.UnitModules,this.tabViewCollection=new CoursePress.Views.UnitTabViewCollection({model:this.unit_collection,tagName:"ul",className:"sticky-tabs"}),this.tabViewCollection.parentView=this,this.headerView=new CoursePress.Views.UnitBuilderHeader,this.headerView.parentView=this,this.contentView=new CoursePress.Views.UnitBuilderBody({model:this.module_collection,className:"unit-builder-body"}),this.contentView.parentView=this,this.activePage=1,this.totalPages=1,this.activeUnitStatus="draft",this.activeModuleRef="",this.render()},events:{"click .unit-save-button":"saveUnit","change #unit-live-toggle":"toggleUnitState","change #unit-live-toggle-2":"toggleUnitState","click .unit-delete-module-button":"deleteModule","click .unit-delete-page-button":"deletePage","click .unit-delete-button":"deleteUnit","click .button-add-new-unit":"newUnit","click .unit-builder-tabs ul.sticky-tabs li":"changeActive","click .button-preview":"toPreview"},render:function(){var t=_.template(e("#unit-builder-template").html());return this.$el.html(t),this.$(".unit-builder-tabs .sticky-wrapper .tabs").replaceWith(this.tabViewCollection.el),this.$(".unit-builder-header").append(this.headerView.el),this.$(".unit-builder-body").replaceWith(this.contentView.el),e(".sticky-wrapper-tabs").sticky({topSpacing:45}),this},fetchModules:function(e,t){this.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules&course_id="+_coursepress.course_id+"&unit_id="+e+"&page="+t,this.module_collection.fetch({success:function(){this.$(".unit-save-button").removeClass("disabled")}});var s=this.unit_collection._byId[this.activeUnitRef].get("meta");this.totalPages=s.page_title?s.page_title.length:1,this.totalPages=void 0===this.totalPages?_.size(s.page_title):1,this.activeModuleRef=""},userCap:function(e){var t=this.unit_collection._byId[this.activeUnitRef].get("user_cap");return t[e]},saveUnit:function(t){e(t.target).hasClass("disabled")||CoursePress.Helpers.Module.save_unit(t)},toggleUnitState:function(e){CoursePress.Helpers.Module.toggle_unit_state(e)},deleteModule:function(t){if(window.confirm(_coursepress.unit_builder_delete_module_confirm)){var s=t.currentTarget,a=e(s).parents(".module-holder")[0],i=e(a).attr("data-cid");this.module_collection.remove(i),e(a).parents(".group").detach()}},deletePage:function(e){var t=this;if(window.confirm(_coursepress.unit_builder_delete_page_confirm)){var s=parseInt(this.activePage);CoursePress.Helpers.Module.delete_page(e,t.activeUnitID,s),location.reload()}},deleteUnit:function(t){if(window.confirm(_coursepress.unit_builder_delete_unit_confirm)){this.unit_collection.remove(this.activeUnitRef),e('ul li[data-tab="'+this.activeUnitID+'"]').detach(),e(e(".unit-builder-body")[0]).empty(),e('.unit-detail input[type="text"]').val(""),e('.unit-detail input[type="checkbox"]').removeAttr("checked"),e("#unit-live-toggle").removeClass("on").addClass("off"),e("#unit-live-toggle-2").removeClass("on").addClass("off"),e(e('li[data-tab="units"] a')[0]).html(e(e('li[data-tab="units"] a')[0]).html().replace(/\d+/,e(".unit-builder-tabs ul li").length)),CoursePress.Helpers.Module.save_unit(t);var s=this.tabViewCollection.$el.find("li").last();s&&s.length>0&&s.trigger("click",s)}},newUnit:function(t){this.is_add=!0;var s=this,a=e(".unit-builder-tabs .sticky-tabs li").length,i=new CoursePress.Models.Unit;i.set_meta("unit_order",a+1),i.set_meta("page_title",{page_1:""}),i.set_meta("show_page_title",[!0]),i.set("post_title",_coursepress.unit_builder_new_unit_title),s.unit_collection.add(i),CoursePress.Helpers.Module.save_unit(t,"new_success");var r=new CoursePress.Views.UnitTabView({model:i,tagName:"li"}),n=r.render().$el;e(".button-add-new-unit .fa").removeClass("fa-plus-square").addClass("fa-spinner").addClass("fa-spin"),s.unit_collection.on("new_success",function(){s.unit_collection.fetch({success:function(){e(".button-add-new-unit .fa").removeClass("fa-spin").removeClass("fa-spinner").addClass("fa-plus-square"),e(".unit-builder-tabs ul.sticky-tabs").append(n),CoursePress.Helpers.Module.refresh_ui(),e(e('li[data-tab="units"] a')[0]).html(e(e('li[data-tab="units"] a')[0]).html().replace(/\d+/,e(".unit-builder-tabs ul li").length))}}),s.unit_collection.off("new_success")})},changeActive:function(t){e("#unit-builder .tab-tabs li").removeClass("active"),e(t.currentTarget).addClass("active");var s=e(t.currentTarget).attr("data-tab"),a=this;this.unit_collection.each(function(e){parseInt(s)===parseInt(e.get("ID"))&&CoursePress.Helpers.changeUnit(e,a)})},toPreview:function(t){var s=e(t.currentTarget),a=s.data("href");s.attr("href",a+this.activeUnitID)}}),CoursePress.Models.Unit=Backbone.Model.extend({initialize:function(){this.url=_coursepress._ajax_url+"?action=unit_builder&task=unit_update&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID,this.on("change",this.process_changed,this),this.on("sync",this.model_saved,this)},set_meta:function(e,t){e=e.replace("meta_","");var s=this.get("meta")||{};s[e]=t,this.set("flag","dirty"),this.set("meta",s),this.trigger("change",this)},set_page_title:function(e,t){var s=this.get("meta")||{};s.page_title=s.page_title||{},s.page_title["page_"+e]=t,this.set("meta",s),this.trigger("change",this)},set_page_description:function(e,t){var s=this.get("meta")||{};t=_.escape(t),s.page_description=s.page_description||{},s.page_description["page_"+e]=t,this.set("meta",s),this.trigger("change",this)},set_page_image:function(e,t){var s=this.get("meta")||{};s.page_feature_image=s.page_feature_image||{},s.page_feature_image["page_"+e]=t,this.set("meta",s),this.trigger("change",this)},set_page_visibility:function(e,t){var s=this.get("meta")||{},a=e-1;s.show_page_title&&(s.show_page_title[a]=t,this.set("meta",s),this.trigger("change",this))},get_page_title:function(e){var t=this.get("meta")||{};return t.page_title?t.page_title["page_"+e]:""},get_page_description:function(e){var t=this.get("meta")||{};return t.page_description?t.page_description["page_"+e]:""},get_page_image:function(e){var t=this.get("meta")||{};return t.page_feature_image?t.page_feature_image["page_"+e]:""},get_page_visibility:function(e){var t=this.get("meta")||{};return t.show_page_title?t.show_page_title[e-1]:!0},process_changed:function(){this.set("flag","dirty")},model_saved:function(){}}),CoursePress.Models.Module=Backbone.Model.extend({initialize:function(){var t=e("#unit-builder").attr("data-nonce");this.url=_coursepress._ajax_url+"?action=unit_builder&task=module_add&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&wp_nonce="+t,this.on("change",this.process_changed,this),this.on("sync",this.model_saved,this)},get_meta:function(e,t){e=e.replace("meta_",""),void 0===t&&(t="");var s=this.get("meta")||{},a=s[e]?s[e]:t,i=_.isString(a)?a.toLowerCase():a;return("yes"===i||"on"===i||"no"===i||"off"===i)&&(a=this.fix_boolean(a)),s.legacy_updated||0!==a.length&&a!==!1&&0!==a||(a=this.get_legacy_meta(e,t)),a},get_legacy_meta:function(e,t){var s,a;switch(e){case"duration":e="time_estimation";break;case"show_title":e="show_title_on_front";break;case"mandatory":e="mandatory_answer";break;case"assessable":e="gradable_answer";break;case"minimum_grade":e="minimum_grade_required";break;case"allow_retries":return s=this.get("meta"),s.limit_attempts?(a=s.limit_attempts[0],!this.fix_boolean(a)):t;case"retry_attempts":e="limit_attempts_value";break;case"order":e="module_order";break;case"page":e="module_page";break;case"answers_selected":e="input-radio"===this.module_type()?"checked_answer":"checked_answers"}return s=this.get("meta")||{},a=s[e]?s[e]:t},fix_legacy_module:function(e){var t=this,s=t.get("meta");if(t.set("flag","dirty"),s.module_type=e,s.checked_answer&&(s.answers_selected=s.checked_answer),s.checked_answers&&(s.answers_selected=s.checked_answers),s.time_estimation&&(s.duration=s.time_estimation),s.show_title_on_front&&(s.show_title=t.fix_boolean(s.show_title_on_front)),s.mandatory_answer&&(s.mandatory=t.fix_boolean(s.mandatory_answer)),s.gradable_answer&&(s.assessable=t.fix_boolean(s.gradable_answer)),s.minimum_grade_required&&(s.minimum_grade=s.minimum_grade_required),s.limit_attempts){var a=t.fix_boolean(s.limit_attempts);s.allow_retries=!a}s.limit_attempts_value&&(s.retry_attempts=s.limit_attempts_value),t.set("meta",s)},map_legacy_type:function(e){var t=this,s={audio_module:"audio",chat_module:"chat",checkbox_input_module:"input-checkbox",file_module:"download",file_input_module:"input-upload",image_module:"image",radio_input_module:"input-radio",page_break_module:"section",section_break_module:"section",text_module:"text",text_input_module:"input-text",textarea_input_module:"input-textarea",video_module:"video"};return e in s&&(e="single"!==this.get_meta("checked_length","single")?"input-textarea":s[e],t.fix_legacy_module(e)),e},module_type:function(){return this.map_legacy_type(this.get_meta("module_type"))},fix_boolean:function(e){var t=_.isString(e)?e.toLowerCase():e;return 1===parseInt(t)||"on"===t||"yes"===t||!0===t},set_meta:function(e,t){e=e.replace("meta_","");var s=this.get("meta")||{};s[e]=t,this.set("flag","dirty"),this.set("meta",s),this.trigger("change",this)},from_template:function(t){var s=JSON.parse(_coursepress.unit_builder_templates[t]);this.set("ID",s.id),this.set("post_title",s.title),this.set_meta("duration",s.duration||"1:00"),this.set_meta("module_type",s.type),this.set_meta("mandatory",s.mandatory),this.set_meta("show_title",s.show_title||!0),this.set_meta("assessable",s.assessable),this.set_meta("minimum_grade",s.minimum_grade),this.set_meta("allow_retries",s.allow_retries),this.set_meta("retry_attempts",s.retry_attempts),"input-quiz"===s.type&&this.set_meta("use_timer",s.use_timer),"input-form"===s.type&&this.set_meta("use_timer",s.use_timer),this.set("post_content",s.content||""),this.set_meta("order",s.order);var a=this;e.each(s.components,function(t,s){e.each(s.items,function(e,t){a.item_to_meta(t)})})},item_to_meta:function(e){var t=this;switch(e.type){case"media-browser":case"text-input":t.set_meta(e.name,"");break;case"checkbox-select":case"select-select":case"radio-select":t.set_meta(e.name,e.answers),t.set_meta(e.name+"_selected",e.selected);break;case"media-caption-settings":t.set_meta(e.enable_name,!1),t.set_meta(e.option_name,"media"),t.set_meta(e.input_name,"");break;case"checkbox":t.set_meta(e.name,!1)}},model_saved:function(e){CoursePress.UnitBuilder.activeModuleRef=e.cid,CoursePress.UnitBuilder.gotoAdded=!0},process_changed:function(){CoursePress.UnitBuilder.activeModuleRef=this.cid,this.set("flag","dirty")}}),CoursePress.Collections.UnitTabs=Backbone.Collection.extend({model:CoursePress.Models.Unit}),CoursePress.Collections.UnitModules=Backbone.Collection.extend({model:CoursePress.Models.Module}),CoursePress.Views.UnitTabView=Backbone.View.extend({render:function(){var t=this.model.get("post_status"),s=this.model.get("meta"),a={unit_id:this.model.get("ID"),unit_title:this.model.get("post_title"),unit_live_class:"publish"===t?"unit-live":"unit-draft",unit_active_class:this.first?"active":"",unit_order:s.unit_order,unit_cid:this.model.cid},i=_.template(e("#unit-builder-tab-template").html());return this.$el=i(a),this}}),CoursePress.Views.UnitTabViewCollection=Backbone.View.extend({initialize:function(){this.model.on("sync",this.render,this)},events:{},render:function(){var e=this;e.$el.empty();var t=0,s=this.model.length;return this.parentView.is_add&&(t=s-1),this.model.each(function(s,a){var i=new CoursePress.Views.UnitTabView({model:s,tagName:"li"});i.first=t===a,e.$el.append(i.render().$el),t===a?CoursePress.Helpers.changeUnit(s,e):(e.parentView.contentView.initial=!0,e.parentView.contentView.render())}),this.model.trigger("rendered",this.model),this},changeActive:function(t){e("#unit-builder .tab-tabs li").removeClass("active"),e(t.currentTarget).addClass("active");var s=e(t.currentTarget).attr("data-tab"),a=this;this.model.each(function(t){parseInt(s)===parseInt(t.get("ID"))&&(CoursePress.Helpers.changeUnit(t,a),e("body,html").animate({scrollTop:e(".section.unit-builder-header").offset().top-20,duration:200}))})}}),CoursePress.Helpers.changeUnit=function(e,t,s){t=CoursePress.UnitBuilder,void 0===s&&(s=1),t.activePage=s,t.headerView.template_variables.unit_id=e.get("ID"),t.headerView.template_variables.unit_cid=e.cid,t.headerView.template_variables.unit_title=e.get("post_title"),t.headerView.template_variables.unit_content=e.get("post_content");var a=e.get("meta");t.headerView.template_variables.unit_availability=a.unit_availability,t.headerView.template_variables.unit_date_availability=a.unit_date_availability?a.unit_date_availability:"",t.headerView.template_variables.unit_delay_days=a.unit_delay_days?a.unit_delay_days:0,t.headerView.template_variables.unit_feature_image=a.unit_feature_image;var i=a.force_current_unit_completion;i="on"===i||!0===i||1===parseInt(i)?'checked="checked"':"",t.headerView.template_variables.unit_force_completion_checked=i,i=a.force_current_unit_successful_completion,i="on"===i||!0===i||1===parseInt(i)?'checked="checked"':"",t.headerView.template_variables.unit_force_successful_completion_checked=i,t.headerView.render(),t.headerView.$el.find('[name="meta_unit_availability"]').trigger("change",t.headerView),t.contentView.initial=!0,t.contentView.render(),t.activeUnitID=e.get("ID"),t.activeUnitRef=e.cid,t.activeUnitStatus=e.get("post_status"),t.fetchModules(t.activeUnitID,t.activePage);var r=e.get("user_cap"),n=t.$el.find(".unit-builder-no-access");r.coursepress_update_course_unit_cap?(t.headerView.$el.show(),t.contentView.$el.show(),n.hide()):(t.headerView.$el.hide(),t.contentView.$el.hide(),n.show())},CoursePress.Views.UnitBuilderHeader=Backbone.View.extend({initialize:function(){this.template_variables={unit_id:"",unit_cid:"",unit_title:"",unit_content:"",unit_feature_image:"",unit_availability:"",unit_date_availability:"",unit_delay_days:0,unit_force_completion_checked:"",unit_force_successful_completion_checked:""},this.render(),CoursePress.Events.on("editor:keyup",this.editorChanged,this)},events:{"change .unit-detail input":"fieldChanged","keyup .unit-detail input[name=post_title]":"updateTabTitle","keyup .unit-detail .wp-unit-editor":"editorChanged","change #unit-live-toggle":"toggleUnitState","change #unit-live-toggle-2":"toggleUnitState","change #unit_feature_image":"unitFeatureImageChange",'change [name="unit_feature_image-button"]':"unitFeatureImageChange",'change [name="meta_unit_availability"]':"toggleAvailability",'focus [name="meta_unit_date_availability"]':"setDate","change select":"fieldChanged"},render:function(){var t=this.template_variables;0===parseInt(t.unit_delay_days)&&(t.unit_delay_days="");var s=_.template(e("#unit-builder-header-template").html());return this.$el.html(s(t)),e("#unit_feature_image").val(t.unit_feature_image),this.updateUnitHeader(),this},editorChanged:function(t){var s=t.id,a=/^unit_description_\d+$/;if(void 0===s&&(s=e(t.currentTarget).attr("id")),void 0!==s&&a.test(s)){var i=e("#"+s),r=CoursePress.editor.content(s),n=e(i).parents(".unit-detail")[0],o=this.parentView.unit_collection._byId[e(n).attr("data-cid")];r=_.escape(r),o.set("post_content",r)}},fieldChanged:function(t){var s=e(t.currentTarget),a=e(s).attr("name");if("unit_feature_image"!==a&&"unit_feature_image-button"!==a&&"page_feature_image"!==a&&"page_feature_image-button"!==a){var i=e(s).val(),r=e(s).parents(".unit-detail")[0],n=this.parentView.unit_collection._byId[e(r).attr("data-cid")],o=e(s).attr("type");"checkbox"===o&&(i=e(s).is(":checked")),n&&(/meta_/.test(a)?n.set_meta(a,i):n.set(a,i))}},unitFeatureImageChange:function(t){var s=e(t.currentTarget),a=e("#unit_feature_image").val(),i=s.parents(".unit-detail").first(),r=this.parentView.unit_collection._byId[i.attr("data-cid")];r.set_meta("unit_feature_image",a)},updateTabTitle:function(t){e('[data-tab="'+this.parentView.activeUnitID+'"] span').html(e(t.currentTarget).val())},toggleUnitState:function(e){CoursePress.Helpers.Module.toggle_unit_state(e)},updateUnitHeader:function(){e.each(e(".unit-wp-editor"),function(t,s){var a=e(s).attr("id");tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a);var i=e("#"+a).val(),r=e(s).attr("name"),n=e(s).attr("data-height")?e(s).attr("data-height"):200;CoursePress.editor.create(s,a,r,i,!1,n)})},toggleAvailability:function(t){var s=e(t.currentTarget),a=s.val(),i=s.parent().find(".ua-div"),r=s.parent().find(".div-"+a);i.hide(),r.length>0&&r.show()},setDate:function(t){var s=e(t.target);s.datepicker()}}),CoursePress.Views.UnitBuilderFooter=Backbone.View.extend({render:function(){var t=_.template(e("#unit-builder-footer-template").html());return this.$el.empty(),this.$el.html(t),this}}),CoursePress.Views.UnitBuilderBody=Backbone.View.extend({initialize:function(){this.initial=!0,this.pagerView=new CoursePress.Views.UnitBuilderPager({className:"section unit-builder-pager"}),this.pagerView.parentView=this,this.pagerView.template_variables={},this.pagerViewInfo=new CoursePress.Views.UnitBuilderPagerInfo({className:"section unit-builder-pager-info"}),this.pagerViewInfo.parentView=this,this.pagerViewInfo.template_variables={},this.componentsView=new CoursePress.Views.UnitBuilderComponents({className:"section unit-builder-components"}),this.componentsView.parentView=this,this.componentsView.template_variables={},this.modulesView=new CoursePress.Views.UnitBuilderModules({className:"section unit-builder-modules"}),this.modulesView.parentView=this,this.modulesView.template_variables={},this.footerView=new CoursePress.Views.UnitBuilderFooter({className:"unit-buttons"}),this.footerView.parentView=this,this.model.on("sync",this.render,this),CoursePress.Events.on("editor:keyup",this.editorChanged,this)},render:function(){var t;if(this.initial)t=_.template(e("#unit-builder-content-placeholder").html()),this.$el.html(t),this.initial=!1;else{t=_.template(e("#unit-builder-content-template").html()),this.$el.html(t);var s=this.parentView.unit_collection._byId[this.parentView.activeUnitRef];this.pagerView.template_variables.unit_page_count=this.parentView.totalPages,this.pagerView.template_variables.pages_titles=s.attributes.meta.page_title,this.$(".unit-builder-pager").replaceWith(this.pagerView.render(this.pagerView.template_variables).el),s=this.parentView.unit_collection._byId[this.parentView.activeUnitRef];var a=s.get_page_visibility(this.parentView.activePage);if(a=a||!1===a?_.isString(a)&&("yes"===a.toLowerCase()||"on"===a.toLowerCase())||1===parseInt(a)||!0===a:!0,this.pagerViewInfo.template_variables={page_label_text:s.get_page_title(this.parentView.activePage),page_description:s.get_page_description(this.parentView.activePage),page_feature_image:s.get_page_image(this.parentView.activePage),page_label_checked:a?'checked="checked"':""},this.$(".unit-builder-pager-info").replaceWith(this.pagerViewInfo.render(this.pagerViewInfo.template_variables).el),this.componentsView.template_variables={},this.$(".unit-builder-components").replaceWith(this.componentsView.render(this.componentsView.template_variables).el),this.$(".unit-builder-modules").replaceWith(this.modulesView.render(this.parentView.module_collection.models).el),this.$(".unit-builder-footer").append(this.footerView.render().el),this.$(".unit-save-button").removeClass("disabled"),CoursePress.Helpers.Module.refresh_ui(),this.updateSectionEditor(),e("#page_feature_image").val(this.pagerViewInfo.template_variables.page_feature_image),CoursePress.UnitBuilder.gotoAdded===!0){CoursePress.UnitBuilder.gotoAdded=!1;var i=e("[data-cid="+CoursePress.UnitBuilder.activeModuleRef+"]");e("body,html").scrollTop(e(i).offset().top-80)}}return e(".page-info-holder input[name=page_title]").on("keyup",function(){label=e(this).val(),label=label.length>19?label.substr(0,19)+"":label,e(".unit-builder-pager li.active").html(label)}),this},events:{"click .unit-builder-components .output-element":"add_element","click .unit-builder-components .input-element":"add_element","change .button.browse-media-field":"fieldChanged","change .module-holder input":"fieldChanged","change textarea":"fieldChanged","change select":"selectionChanged","change .page-info-holder input":"unitPageInfoChanged","keyup .module-title-text":"updateUIHeading","click .unit-builder-pager ul li":"changePage","click .module-component .add-item":"addAnswer","click .module-component .remove-item":"removeAnswer","change #page_feature_image":"pageFeatureImageChange",'change [name="page_feature_image-button"]':"pageFeatureImageChange"},pageFeatureImageChange:function(t){var s=e(t.currentTarget),a=e("#page_feature_image").val(),i=this.parentView.activePage,r=e(e(s).parents(".unit-builder-content")[0]).find(".unit-detail")[0],n=this.parentView.unit_collection._byId[e(r).attr("data-cid")];n.set_page_image(i,a)},add_element:function(t){CoursePress.Helpers.Module.unit_add_show_message('<i class="fa fa-circle-o-notch fa-spin"></i> '+_coursepress.unit_builder_form.messages.adding_module,"info");var s=t.currentTarget,a=e(s).attr("class").match(/module-(\w|-)*/g)[0].trim().replace("module-",""),i=e(".module-holder").length,r=new CoursePress.Models.Module;r.from_template(a),r.set_meta("module_order",i+1),r.set_meta("module_page",this.parentView.activePage),r.save(null,{success:function(){e(".section.unit-builder-components .notice").detach()}}),this.parentView.module_collection.add(r)},fieldChanged:function(t){var s=e(t.currentTarget),a=e(s).attr("name");if("unit_feature_image"!==a&&"unit_feature_image-button"!==a&&"page_feature_image"!==a&&"page_feature_image-button"!==a){var l,i=e(s).val(),r=e(s).parents(".module-holder")[0],n=this.parentView.module_collection._byId[e(r).attr("data-cid")],o=e(s).attr("type");if("checkbox"===o&&(l=e('[name="'+a+'"]'),a=a.replace(/\[.*\]/,""),l.length>1?(i=[],e.each(l,function(t,s){e(s).is(":checked")&&i.push(t)})):i=e(s).is(":checked")),"radio"===o&&(a=a.replace(/\[.*\]/,"")),("text"===o||"textbox"===o)&&/\[\]/.test(a)){var u=e(s).parents(".module-component");if(u.length>0)return l=e(u).find('[name="'+a+'"]'),a=a.replace(/\[.*\]/,""),i=[],e.each(l,function(t,s){i.push(e(s).val())}),void n.set_meta(a,i)}if("button"===o&&e(s).hasClass("browse-media-field")){var d=e(e(s)[0]).siblings("[type=text]")[0];a=e(d).attr("name"),i=e(d).val()}/meta_/.test(a)?n.set_meta(a,i):n.set(a,i)}},selectionChanged:function(t){var s=e(t.currentTarget),a=e(s).attr("name"),i=e(s).val(),r=e(s).parents(".module-holder")[0],n=this.parentView.module_collection._byId[e(r).attr("data-cid")];/meta_/.test(a)?n.set_meta(a,i):n.set(a,i)},editorChanged:function(t){var s=t.id,a=e("#"+s).parents(".module-holder")[0];if(void 0!==a){var i=this.parentView.module_collection._byId[e(a).attr("data-cid")],r=/post_content_/.test(s)?s.replace(/(_\d+)+$/,""):s,n=CoursePress.editor.content(s);/meta_/.test(r)?i.set_meta(r,n):i.set(r,n)}},updateUIHeading:function(t){var s=e(t.currentTarget),a=e(s.parents(".module-holder").first()).siblings("h3").first();e(a).find(".label").html(s.val())},changePage:function(t){var s=this,a=e(t.currentTarget).attr("data-page"),i=s.parentView.unit_collection._byId[s.parentView.activeUnitRef];a?(s.parentView.activePage=e(t.currentTarget).attr("data-page"),s.parentView.fetchModules(s.parentView.activeUnitID,s.parentView.activePage)):(s.parentView.activePage=e(".unit-builder-pager ul li").length,s.parentView.totalPages=s.parentView.activePage,i.set_page_title(s.parentView.activePage,""),i.set_page_visibility(s.parentView.activePage,!0),s.parentView.fetchModules(s.parentView.activeUnitID,s.parentView.activePage))},unitPageInfoChanged:function(t){var s=e(t.currentTarget),a=e(s).attr("name"),i=e(s).val(),r=this.parentView.unit_collection._byId[this.parentView.activeUnitRef],n=e(s).attr("type");switch("checkbox"===n&&(i=e(s).is(":checked")),a){case"page_title":r.set_page_title(this.parentView.activePage,i);break;case"show_page_title":r.set_page_visibility(this.parentView.activePage,i)}r.trigger("change",r)},addAnswer:function(t){var s=t.currentTarget,a=e(s).siblings(".answer-group"),i=e(s).parents(".module-holder"),r=e(i).attr("data-cid"),n=e(i).find(".answer"),o=n.length,l=e(e(s).parents(".module-holder")[0]).attr("class").match(/input-radio|input-select/)?"radio":"checkbox",u=e(e(s).parents(".module-holder")[0]).attr("class").match(/input-radio|input-select/)?"meta_answers_selected["+r+"]":"meta_answers_selected["+r+"][]";e(a).append('<div class="answer"><input type="'+l+'" value="'+o+'" name="'+u+'"><input class="component-'+l+'-answer wide" type="text" name="meta_answers[]" value=""> <span class="remove-item"><i class="fa fa-trash-o"></i></span></div>')},removeAnswer:function(t){var s=t.currentTarget,a=e(s).parents(".answer-group"),i=e(s).parents(".answer"),r=e(s).parents(".module-holder"),n=e(r).attr("data-cid"),o=this.parentView.module_collection._byId[n];i.detach();var l=e(a).find('[name="meta_answers_selected['+n+'][]"]'),u=[];e.each(l,function(t,s){e(s).is(":checked")&&u.push(t),e(s).val(t)}),o.set_meta("meta_answers_selected",u),l=e(a).find('[name="meta_answers[]"]'),u=[],e.each(l,function(t,s){u.push(e(s).val())}),o.set_meta("meta_answers",u)},updateSectionEditor:function(){e.each(e(".page-wp-editor"),function(t,s){var a=e(s).attr("id");tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a);var i=e("#"+a).val(),r=e(s).attr("name"),n=e(s).attr("data-height")?e(s).attr("data-height"):200;CoursePress.editor.create(s,a,r,i,!1,n)})}}),CoursePress.Views.UnitBuilderPager=Backbone.View.extend({render:function(t){var s=_.template(e("#unit-builder-pager-template").html());return this.$el.html(s(t)),this}}),CoursePress.Views.UnitBuilderPagerInfo=Backbone.View.extend({initialize:function(){CoursePress.Events.on("editor:keyup",this.editorChanged,this)},events:{"change .page-info-holder input":"fieldChanged","keyup .unit-detail .page-wp-editor":"editorChanged"},render:function(t){var s=_.template(e("#unit-builder-pager-info-template").html());
return t.page_id=Math.floor(1e10*Math.random()),this.$el.html(s(t)),this},editorChanged:function(t){var s=this.parentView.parentView.activePage,a=t.id,i=/^page_description_\d+$/;if(void 0===a&&(a=e(t.currentTarget).attr("id")),void 0!==a&&i.test(a)){var r=e("#"+a),n=CoursePress.editor.content(a),o=e(e(r).parents(".unit-builder-content")[0]).find(".unit-detail")[0],l=this.parentView.parentView.unit_collection._byId[e(o).attr("data-cid")];l.set_page_description(s,n)}}}),CoursePress.Views.UnitBuilderComponents=Backbone.View.extend({render:function(t){var s=_.template(e("#unit-builder-components-template").html());return this.$el.html(s(t)),this}}),CoursePress.Views.UnitBuilderModules=Backbone.View.extend({render:function(){var e=this;return e.$el.empty(),this.parentView.model.each(function(t){var s=new CoursePress.Views.ModuleView({model:t,tagName:"div",className:"group group-"+t.module_type()}),a=t.get_meta("module_order");e.$el.append(s.render(t,a).$el)}),this}}),CoursePress.Views.ModuleView=Backbone.View.extend({render:function(e,t){var s=this;return s.$el.empty(),s.$el.append(CoursePress.Helpers.Module.render_module(e,t)),CoursePress.Helpers.Module.refresh_ui(),this}}),e(document).ready(t)}(jQuery);