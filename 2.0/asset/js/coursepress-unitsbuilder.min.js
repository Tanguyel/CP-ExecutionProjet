var CoursePress=CoursePress||{};!function(e){function s(){CoursePress.UnitBuilder=new CoursePress.Views.UnitBuilder({el:"#unit-builder"})}CoursePress.Views=CoursePress.Views||{},CoursePress.Models=CoursePress.Models||{},CoursePress.Collections=CoursePress.Collections||{},CoursePress.Helpers=CoursePress.Helpers||{},CoursePress.Helpers.Module=CoursePress.Helpers.Module||{},CoursePress.Helpers.Module.quiz=CoursePress.Helpers.Module.quiz||{},CoursePress.Helpers.Module.form=CoursePress.Helpers.Module.form||{},CoursePress.Helpers.Module.refresh_ui=function(){e.each(e(".unit-builder-modules .editor"),function(s,t){var a=e(t).attr("id");if("undefined"==typeof tinyMCE.editors[a]){var r=e("#"+a).val(),i=e(t).attr("name"),n=e(t).attr("data-height")?e(t).attr("data-height"):400;CoursePress.editor.create(t,a,i,r,!1,n)}}),e(".unit-builder-modules").hasClass("ui-accordion")&&e(".unit-builder-modules").accordion("destroy");var s=0;if(CoursePress.UnitBuilder.activeModuleRef&&CoursePress.UnitBuilder.activeModuleRef.length>0){var t=e('[data-cid="'+CoursePress.UnitBuilder.activeModuleRef+'"]')[0];s=parseInt(e(t).attr("data-order"))-1}e(".unit-builder-modules").accordion({heightStyle:"content",collapsible:!0,header:"> div > h3",active:s}).sortable({axis:"y",handle:"h3",stop:function(s,t){t.item.children("h3").triggerHandler("focusout",t);var a=e(".module-holder");e.each(a,function(s,t){var a=parseInt(e(t).attr("data-order")),r=s+1,i=e(t).attr("data-cid");e(t).attr("data-order",r),a!==r&&(CoursePress.UnitBuilder.module_collection._byId[i].set_meta("module_order",r),e(t).addClass("dirty"))}),e(this).accordion("refresh");var r=this.getElementsByClassName("wp-editor-tabs");e.each(r,function(e,s){for(;s.hasChildNodes();)s.removeChild(s.lastChild)});var i=document.querySelectorAll('textarea[id^="post_content_"]');e.each(i,function(e,s){tinymce.execCommand("mceRemoveEditor",!0,s.id),tinymce.execCommand("mceAddEditor",!0,s.id)})}}),e(".unit-builder-tabs ul").sortable({stop:function(){var s=e(".unit-builder-tabs ul li");e.each(s,function(s,t){var a=parseInt(e(t).attr("data-order")),r=s+1,i=e(t).attr("data-cid");if(e(t).attr("data-order",r),a!==r){var n=CoursePress.UnitBuilder.unit_collection._byId[i].get("meta");n.unit_order=r,CoursePress.UnitBuilder.unit_collection._byId[i].set("meta",n),CoursePress.UnitBuilder.unit_collection._byId[i].set("flag","dirty"),e(t).addClass("dirty")}})}}),e(".button.browse-media-field").browse_media_field(),e(".unit-builder-pager ul li").removeClass("active"),e('.unit-builder-pager ul li[data-page="'+CoursePress.UnitBuilder.activePage+'"]').addClass("active"),"publish"===CoursePress.UnitBuilder.activeUnitStatus?(e("#unit-live-toggle").removeClass("off"),e("#unit-live-toggle").addClass("on"),e("#unit-live-toggle-2").removeClass("off"),e("#unit-live-toggle-2").addClass("on")):(e("#unit-live-toggle").removeClass("on"),e("#unit-live-toggle").addClass("off"),e("#unit-live-toggle-2").removeClass("on"),e("#unit-live-toggle-2").addClass("off"));var a=CoursePress.UnitBuilder.unit_collection.get(CoursePress.UnitBuilder.activeUnitRef),r=a&&a.get("user_cap")?a.get("user_cap"):{},i=r.coursepress_change_unit_status_cap;e(".coursepress-ui-toggle-switch").each(function(){var s=e(this),t=s.attr("name"),a=!0;"publish-course-toggle"===t&&(CoursePress.current_user_can("coursepress_change_status_cap")||(a=!1)),("unit-live-toggle"===t||"unit-live-toggle-2"===t)&&(i||(a=!1,s.unbind("click"))),a&&s.coursepress_ui_toggle()});var n=CoursePress.UnitBuilder.$el.find(".unit-delete-button"),o=r.coursepress_delete_course_units_cap;n[o?"show":"hide"](),1===CoursePress.UnitBuilder.totalPages?e(".unit-delete-page-button").addClass("hidden"):e(".unit-delete-page-button").removeClass("hidden"),e(".unit-builder-pager ul li[data-page]").droppable({activeClass:"page-droppable",hoverClass:"page-droppable-hover",accept:".unit-builder-modules .group",tolerance:"pointer",drop:function(s,t){var a=s.target,r=parseInt(e(a).attr("data-page")),i=CoursePress.UnitBuilder.activePage,n=t.draggable;if(i!==r){var o=e(e(n).find(".module-holder")[0]).attr("data-cid"),u=CoursePress.UnitBuilder.module_collection._byId[o].get("meta");u.module_page=r,u.module_order=u.module_order+900,CoursePress.UnitBuilder.module_collection._byId[o].set("meta",u),CoursePress.UnitBuilder.module_collection._byId[o].trigger("change",CoursePress.UnitBuilder.module_collection._byId[o]),e(n).detach()}}}),e(".dateinput").datepicker({dateFormat:"yy-mm-dd"}),e(".date").off("sync"),e(".date").on("click",function(){e(this).find(".dateinput").datepicker("show")});var u=e(".button-add-new-unit");u=u.length>0?u.position().top+e(".button-add-new-unit").innerHeight()+20:0;var l=parseFloat(e("#unit-builder .tab-content").css("min-height").replace("px",""));818>l&&(l=818,e("#unit-builder .tab-content").css("min-height",l+"px")),u>l&&e("#unit-builder .tab-content").css("min-height",u+"px"),e(".unit-builder-body .quiz-action-button").off("click"),e(".unit-builder-body .quiz-action-button").on("click",function(){var s=this,t=e(s).parents(".module-components")[0],a=e(s).parents(".module-holder")[0],r=e(t).find(".quiz-question"),i=r.length,n=e(s).attr("data-type"),o='<div class="quiz-question question-'+(i+1)+'" data-id="'+(i+1)+'" data-type="'+n+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">';o+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var u="",l='<div class="question-answer">';switch(n){case"single":var c="single-"+(i+1);u=_coursepress.unit_builder.question_type.single,l+='<div class="answer-group">',l+='<div class="answer"><input type="radio" name="'+c+'" value="" />',l+='<input class="component-radio-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',l+='<div class="answer"><input type="radio" name="'+c+'" value="" />',l+='<input class="component-radio-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',l+="</div>",l+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"multiple":u=_coursepress.unit_builder.question_type.multiple,l+='<div class="answer-group">',l+='<div class="answer"><input type="checkbox" name="" value="" />',l+='<input class="component-checkbox-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',l+='<div class="answer"><input type="checkbox" name="" value="" />',l+='<input class="component-checkbox-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>',l+="</div>",l+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"short":u=_coursepress.unit_builder.question_type.short,l+='<div class="answer-group">',l+='<label data-key="label" class="wide">',l+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",l+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",l+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',l+="</label>",l+="</div>",l+="</div>";break;case"long":u=_coursepress.unit_builder.question_type.long,l+='<div class="answer-group">',l+='<label data-key="label" class="wide">',l+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",l+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",l+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',l+="</label>",l+="</div>",l+="</div>"}l+="</div>",o+='<label class="wide" data-key="label"><span class="label">'+u+":</span></label>",o+="<textarea></textarea>",o+=l,o+="</div>",e(t).append(o),CoursePress.Helpers.Module.quiz.update_meta(a),CoursePress.Helpers.Module.quiz.bind_buttons()}),CoursePress.Helpers.Module.quiz.bind_add_item(),CoursePress.Helpers.Module.form.bind_buttons(),e(".unit-builder-body .form-action-button").off("click"),e(".unit-builder-body .form-action-button").on("click",function(){var s=this,t=e(s).parents(".module-components")[0],a=e(s).parents(".module-holder")[0],r=e(t).find(".quiz-question"),i=r.length,n=e(s).attr("data-type"),o='<div class="quiz-question question-'+(i+1)+'" data-id="'+(i+1)+'" data-type="'+n+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">';o+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var u="",l='<div class="question-answer">';switch(n){case"short":u=_coursepress.unit_builder.question_type.short,l+='<div class="answer-group">',l+='<label data-key="label" class="wide">',l+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",l+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",l+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',l+="</label>",l+="</div>",l+="</div>";break;case"long":u=_coursepress.unit_builder.question_type.long,l+='<div class="answer-group">',l+='<label data-key="label" class="wide">',l+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",l+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",l+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="" />',l+="</label>",l+="</div>",l+="</div>";break;case"selectable":var c="selectable-"+(i+1);u=_coursepress.unit_builder.question_type.selectable,l+='<div class="answer-group">',l+='<div class="answer"><input type="radio" name="'+c+'" value="" />',l+='<input class="component-select-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.a+'" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>',l+='<div class="answer"><input type="radio" name="'+c+'" value="" />',l+='<input class="component-select-answer wide" type="text" value="'+_coursepress.unit_l8n.pre_answers.b+'" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>',l+="</div>",l+='<a class="add-form-item">'+_coursepress.unit_builder_add_answer_label+"</a>"}l+="</div>",o+='<label class="wide" data-key="label"><span class="label">'+u+":</span></label>",o+="<textarea></textarea>",o+=l,o+="</div>",e(t).append(o),CoursePress.Helpers.Module.form.update_meta(a),CoursePress.Helpers.Module.form.bind_buttons()}),CoursePress.Helpers.Module.form.bind_buttons(),e(".module-assessable input").on("change",function(){var s=e(this),t=s.is(":checked"),a=e(s.data("target"),s.parents(".module-header").first()),r=a.find("input");r.attr("readonly",!t)}).change()},CoursePress.Helpers.Module.quiz.render_component=function(s){var t=s.get_meta("questions");if(void 0===t||t.length<=0)return"";var a="";return e.each(t,function(s,t){a+='<div class="quiz-question question-'+(s+1)+'" data-id="'+(s+1)+'" data-type="'+t.type+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">',a+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var r="",i='<div class="question-answer">';switch(t.type){case"single":r=_coursepress.unit_builder.question_type.single,i+='<div class="answer-group">',t.options.answers=t.options.answers||[],e.each(t.options.answers,function(e,a){var r=t.options.checked[e]?"checked=checked":"";i+='<div class="answer"><input type="radio" name="question'+(s+1)+'" value="" '+r+" />",i+='<input class="component-radio-answer wide" type="text" value="'+a+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>'}),i+="</div>",i+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"multiple":r=_coursepress.unit_builder.question_type.multiple,i+='<div class="answer-group">',e.each(t.options.answers,function(e,s){var a=t.options.checked[e]?"checked=checked":"";i+='<div class="answer"><input type="checkbox" name="" value="" '+a+" />",i+='<input class="component-checkbox-answer wide" type="text" value="'+s+'" name="" /><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>'}),i+="</div>",i+='<a class="add-quiz-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"short":break;case"long":}i+="</div>",a+='<label class="wide" data-key="label"><span class="label">'+r+":</span></label>",a+="<textarea>"+t.question+"</textarea>",a+=i,a+="</div>"}),a},CoursePress.Helpers.Module.quiz.update_meta=function(s){var t=e(s).attr("data-cid"),a={},r=CoursePress.UnitBuilder.module_collection._byId[t],i=e(s).find(".quiz-question");e.each(i,function(s,t){var r;switch(a[s]={type:e(t).attr("data-type"),question:e(t).find("textarea").val(),options:{}},a[s].type){case"single":a[s].options.answers=[],a[s].options.checked=[],r=e(t).find(".answer-group .answer"),e.each(r,function(t,r){a[s].options.answers[t]=e(r).find('[type="text"]').val(),a[s].options.checked[t]=e(r).find('[type="radio"]').is(":checked")});break;case"multiple":a[s].options.answers=[],a[s].options.checked=[],r=e(t).find(".answer-group .answer"),e.each(r,function(t,r){a[s].options.answers[t]=e(r).find('[type="text"]').val(),a[s].options.checked[t]=e(r).find('[type="checkbox"]').is(":checked")});break;case"short":break;case"long":}}),r.set_meta("questions",a),r.set("flag","dirty")},CoursePress.Helpers.Module.quiz.bind_add_item=function(){e(".quiz-question .add-quiz-item").off("click"),e(".quiz-question .add-quiz-item").on("click",function(){var s=this,t=e(s).parents(".quiz-question")[0],a=e(t).attr("data-type"),r="single"===a?"radio":"checkbox",i="single"===a?"component-radio-answer wide":"component-checkbox-answer wide",n=e(t).attr("data-type")+"-"+e(t).attr("data-id"),o='<div class="answer"><input type="'+r+'" value="" name="'+n+'"><input type="text" name="" value="" class="'+i+'"><span class="remove-quiz-item"><i class="fa fa-trash-o"></i></span></div>';e(t).find(".answer-group").append(o),CoursePress.Helpers.Module.quiz.bind_remove_item(),CoursePress.Helpers.Module.quiz.bind_checkboxes(),CoursePress.Helpers.Module.quiz.bind_textboxes()})},CoursePress.Helpers.Module.quiz.bind_checkboxes=function(){e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').off("change"),e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').on("change",function(){var s=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.quiz.update_meta(s)})},CoursePress.Helpers.Module.quiz.bind_textboxes=function(){e('.quiz-question [type="text"], .quiz-question textarea').off("keyup"),e('.quiz-question [type="text"], .quiz-question textarea').on("keyup",function(){var s=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.quiz.update_meta(s)})},CoursePress.Helpers.Module.quiz.bind_remove_item=function(){e(".quiz-question .remove-quiz-item").off("click"),e(".quiz-question .remove-quiz-item").on("click",function(){var s=this,t=e(s).parents(".answer")[0],a=e(this).parents(".module-holder")[0];e(t).detach(),CoursePress.Helpers.Module.quiz.update_meta(a)})},CoursePress.Helpers.Module.quiz.bind_remove_question=function(){e(".quiz-question .quiz-question-remove").off("click"),e(".quiz-question .quiz-question-remove").on("click",function(){var s=this,t=e(s).parents(".quiz-question")[0],a=e(t).siblings(".quiz-question"),r=e(this).parents(".module-holder")[0];e.each(a,function(s,t){e(t).attr("class",""),e(t).addClass("quiz-question"),e(t).addClass("question-"+(s+1)),e(t).attr("data-id",s+1)}),e(t).detach(),CoursePress.Helpers.Module.quiz.update_meta(r)})},CoursePress.Helpers.Module.quiz.bind_buttons=function(){CoursePress.Helpers.Module.quiz.bind_add_item(),CoursePress.Helpers.Module.quiz.bind_remove_item(),CoursePress.Helpers.Module.quiz.bind_remove_question(),CoursePress.Helpers.Module.quiz.bind_checkboxes(),CoursePress.Helpers.Module.quiz.bind_textboxes()},CoursePress.Helpers.Module.form.render_component=function(s){var t=s.get_meta("questions");if(void 0===t||t.length<=0)return"";var a="";return e.each(t,function(s,t){a+='<div class="quiz-question question-'+(s+1)+'" data-id="'+(s+1)+'" data-type="'+t.type+'" style="position: relative; border: 1px solid rgba(0,0,0,0.2); margin-top: 10px; padding: 5px;">',a+='<div class="quiz-question-remove" style="position: absolute; top:5px; right:5px; font-weight: bolder; font-size: 1.2em; cursor: pointer;">X</div>';var r="",i='<div class="question-answer">';switch(t.type){case"short":r=_coursepress.unit_builder.question_type.short,i+='<div class="answer-group">',i+='<label data-key="label" class="wide">',i+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",i+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",i+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="'+t.placeholder+'" />',i+="</label>",i+="</div>",i+="</div>";break;case"long":r=_coursepress.unit_builder.question_type.long,i+='<div class="answer-group">',i+='<label data-key="label" class="wide">',i+='<span class="label">'+_coursepress.unit_builder_form_pleaceholder_label+"</span>",i+='<span class="description">'+_coursepress.unit_builder_form_pleaceholder_desc+"</span>",i+='<div class="placeholder"><input class="component-placeholder-text wide" type="text" name="" value="'+t.placeholder+'" />',i+="</label>",i+="</div>",i+="</div>";break;case"selectable":r=_coursepress.unit_builder.question_type.selectable,i+='<div class="answer-group">',t.options.answers=t.options.answers||[],e.each(t.options.answers,function(e,a){var r=t.options.checked[e]?"checked=checked":"";i+='<div class="answer"><input type="radio" name="question'+(s+1)+'" value="" '+r+" />",i+='<input class="component-select-answer wide" type="text" value="'+a+'" name="" /><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>'}),i+="</div>",i+='<a class="add-form-item">'+_coursepress.unit_builder_add_answer_label+"</a>"}i+="</div>",a+='<label class="wide" data-key="label"><span class="label">'+r+":</span></label>",a+="<textarea>"+t.question+"</textarea>",a+=i,a+="</div>"}),a},CoursePress.Helpers.Module.form.update_meta=function(s){var t=e(s).attr("data-cid"),a={},r=CoursePress.UnitBuilder.module_collection._byId[t],i=e(s).find(".quiz-question");e.each(i,function(s,t){var r;switch(a[s]={type:e(t).attr("data-type"),question:e(t).find("textarea").val(),options:{}},a[s].type){case"single":a[s].options.answers=[],a[s].options.checked=[],r=e(t).find(".answer-group .answer"),e.each(r,function(t,r){a[s].options.answers[t]=e(r).find('[type="text"]').val(),a[s].options.checked[t]=e(r).find('[type="radio"]').is(":checked")});break;case"multiple":a[s].options.answers=[],a[s].options.checked=[],r=e(t).find(".answer-group .answer"),e.each(r,function(t,r){a[s].options.answers[t]=e(r).find('[type="text"]').val(),a[s].options.checked[t]=e(r).find('[type="checkbox"]').is(":checked")});break;case"short":a[s].placeholder=e(t).find(".answer-group .placeholder input").val();break;case"long":a[s].placeholder=e(t).find(".answer-group .placeholder input").val();break;case"selectable":a[s].options.answers=[],a[s].options.checked=[],r=e(t).find(".answer-group .answer"),e.each(r,function(t,r){a[s].options.answers[t]=e(r).find('[type="text"]').val(),a[s].options.checked[t]=e(r).find('[type="radio"]').is(":checked")})}}),r.set_meta("questions",a),r.set("flag","dirty")},CoursePress.Helpers.Module.form.bind_add_item=function(){e(".quiz-question .add-form-item").off("click"),e(".quiz-question .add-form-item").on("click",function(){var s=this,t=e(s).parents(".quiz-question")[0],a=e(t).attr("data-type"),r="single"===a||"selectable"===a?"radio":"checkbox",i="single"===a?"component-radio-answer wide":"component-checkbox-answer wide";"selectable"===a&&(i="component-select-answer wide");var n=e(t).attr("data-type")+"-"+e(t).attr("data-id"),o='<div class="answer"><input type="'+r+'" value="" name="'+n+'"><input type="text" name="" value="" class="'+i+'"><span class="remove-form-item"><i class="fa fa-trash-o"></i></span></div>';e(t).find(".answer-group").append(o),CoursePress.Helpers.Module.form.bind_remove_item(),CoursePress.Helpers.Module.form.bind_checkboxes(),CoursePress.Helpers.Module.form.bind_textboxes()})},CoursePress.Helpers.Module.form.bind_checkboxes=function(){e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').off("change"),e('.quiz-question [type="checkbox"], .quiz-question [type="radio"]').on("change",function(){var s=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.form.update_meta(s)})},CoursePress.Helpers.Module.form.bind_textboxes=function(){e('.quiz-question [type="text"], .quiz-question textarea').off("keyup"),e('.quiz-question [type="text"], .quiz-question textarea').on("keyup",function(){var s=e(this).parents(".module-holder")[0];CoursePress.Helpers.Module.form.update_meta(s)})},CoursePress.Helpers.Module.form.bind_remove_item=function(){e(".quiz-question .remove-form-item").off("click"),e(".quiz-question .remove-form-item").on("click",function(){var s=this,t=e(s).parents(".answer")[0],a=e(this).parents(".module-holder")[0];e(t).detach(),CoursePress.Helpers.Module.form.update_meta(a)})},CoursePress.Helpers.Module.form.bind_remove_question=function(){e(".quiz-question .quiz-question-remove").off("click"),e(".quiz-question .quiz-question-remove").on("click",function(){var s=this,t=e(s).parents(".quiz-question")[0],a=e(t).siblings(".quiz-question"),r=e(this).parents(".module-holder")[0];e.each(a,function(s,t){e(t).attr("class",""),e(t).addClass("quiz-question"),e(t).addClass("question-"+(s+1)),e(t).attr("data-id",s+1)}),e(t).detach(),CoursePress.Helpers.Module.form.update_meta(r)})},CoursePress.Helpers.Module.form.bind_buttons=function(){CoursePress.Helpers.Module.form.bind_add_item(),CoursePress.Helpers.Module.form.bind_remove_item(),CoursePress.Helpers.Module.form.bind_remove_question(),CoursePress.Helpers.Module.form.bind_checkboxes(),CoursePress.Helpers.Module.form.bind_textboxes()},CoursePress.Helpers.Module.delete_page=function(s,t,a){var r=e("#unit-builder").attr("data-nonce");CoursePress.UnitBuilder.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules_update_delete_section&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&page="+CoursePress.UnitBuilder.activePage+"&wp_nonce="+r+"&page="+a,Backbone.sync("update",CoursePress.UnitBuilder.module_collection,{success:function(s){e("#unit-builder").attr("data-nonce",s.nonce)},error:function(){}})},CoursePress.Helpers.Module.save_unit=function(s,t){e(".unit-buttons .unit-save-button").prepend('<i class="fa fa-spinner fa-spin save-progress"></i> ');var a=e("#unit-builder").attr("data-nonce"),r=e("#unit-builder").closest("form"),i=e(".component-checkbox-answer, .component-radio-answer, .component-select-answer",r);if(0<i.length){var n=[],o="";if(e.each(i,function(t,a){s=e(a),""===s.val()&&(module_title=e(".module-title .module-title-text",s.closest(".module-holder")).val(),o!==module_title&&(n.push("- "+module_title),o=module_title))}),0<n.length)return e(".save-progress").detach(),alert(_coursepress.unit_builder_form.messages.required_fields+"\n"+n.join("\n")),!1}CoursePress.UnitBuilder.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules_update&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&page="+CoursePress.UnitBuilder.activePage+"&wp_nonce="+a+"&x=1",Backbone.sync("update",CoursePress.UnitBuilder.module_collection,{success:function(s){e("#unit-builder").attr("data-nonce",s.nonce)},error:function(){}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units_update&course_id="+_coursepress.course_id+"&wp_nonce="+a,Backbone.sync("update",CoursePress.UnitBuilder.unit_collection,{success:function(s){e(".save-progress").detach(),a=s.nonce,e("#unit-builder").attr("data-nonce",a),CoursePress.UnitBuilder.unit_collection.trigger(t,CoursePress.UnitBuilder.unit_collection),CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.successfully_saved,"success")},error:function(){e(".save-progress").detach(),e(s.currentTarget).prepend('<i class="fa fa-info-circle save-progress"></i> '),CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.error_while_saving,"error")}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id,CoursePress.Helpers.Module.unit_show_message(_coursepress.unit_builder_form.messages.saving_unit,"info")},CoursePress.Helpers.Module.unit_add_show_message=function(s,t){e(".section.unit-builder-components .notice").detach(),e(".section.unit-builder-components .description").after('<div class="notice notice-'+t+'"><p>'+s+"</p></div>"),"success"===t&&setTimeout(function(){e(".section.unit-builder-components .notice").fadeOut()},3e3)},CoursePress.Helpers.Module.unit_show_message=function(s,t){e(".unit-builder-header .unit-buttons .notice, .unit-builder-footer .unit-buttons .notice").detach(),e(".unit-builder-header .unit-buttons, .unit-builder-footer .unit-buttons").prepend('<div class="notice notice-'+t+'"><p>'+s+"</p></div>"),"success"===t&&setTimeout(function(){e(".unit-builder-header .unit-buttons .notice, .unit-builder-footer .unit-buttons .notice").fadeOut()},3e3)},CoursePress.Helpers.Module.toggle_unit_state=function(){var s=e("#unit-builder").attr("data-nonce");this.switch=function(s,t,a){"publish"===s?(e("#unit-live-toggle").removeClass("off"),e("#unit-live-toggle").addClass("on"),e("#unit-live-toggle-2").removeClass("off"),e("#unit-live-toggle-2").addClass("on")):(e("#unit-live-toggle").removeClass("on"),e("#unit-live-toggle").addClass("off"),e("#unit-live-toggle-2").removeClass("on"),e("#unit-live-toggle-2").addClass("off"));var r=CoursePress.UnitBuilder.unit_collection._byId[a].get("post_status");r!==s&&(CoursePress.UnitBuilder.unit_collection._byId[a].set("post_status",s),CoursePress.UnitBuilder.unit_collection._byId[a].trigger("change",CoursePress.UnitBuilder.unit_collection._byId[a]),e('.unit-builder-tabs [data-tab="'+t+'"]').removeClass("unit-draft"),e('.unit-builder-tabs [data-tab="'+t+'"]').removeClass("unit-live"),e('.unit-builder-tabs [data-tab="'+t+'"]').addClass("publish"===s?"unit-live":"unit-draft"))};var t=this,a=CoursePress.UnitBuilder.activeUnitID,r=CoursePress.UnitBuilder.activeUnitRef,i=CoursePress.UnitBuilder.unit_collection._byId[r].get("post_status");i="publish"===i?"draft":"publish",CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=unit_toggle&course_id="+_coursepress.course_id+"&wp_nonce="+s+"&state="+i+"&unit_id="+a,Backbone.sync("update",CoursePress.UnitBuilder.unit_collection,{success:function(s){t.switch(s.post_status,a,r),e("#unit-builder").attr("data-nonce",s.nonce),CoursePress.UnitBuilder.activeUnitStatus=s.post_status},error:function(s){t.switch(s.post_status,a,r),e("#unit-builder").attr("data-nonce",s.nonce)}}),CoursePress.UnitBuilder.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id},CoursePress.Helpers.Module.render_module=function(e,s){function u(){return'<label class="module-mandatory"><input type="checkbox" name="meta_mandatory['+e.cid+']" value="1" '+CoursePress.utility.checked(i.mandatory,1)+' /><span class="label">'+a.module_mandatory+'</span><span class="description">'+a.module_mandatory_desc+"</span></label>"}function l(){return'<label class="module-assessable"><input type="checkbox" data-target=".module-minimum-grade" name="meta_assessable['+e.cid+']" value="1" '+CoursePress.utility.checked(i.assessable,1)+' /><span class="label">'+a.module_assessable+'</span><span class="description">'+a.module_assessable_desc+"</span></label>"}function c(){return'<label class="module-use-timer"><input type="checkbox" data-target=".module-duration" name="meta_use_timer['+e.cid+']" value="1" '+CoursePress.utility.checked(i.use_timer,1)+' /><span class="label">'+a.module_use_timer+'</span><br /><span class="description">'+a.module_use_timer_desc+"</span></label>"}function d(){return'<label class="module-allow-retries"><input type="checkbox" name="meta_allow_retries['+e.cid+']" value="1" '+CoursePress.utility.checked(i.allow_retries,1)+' /><span class="label">'+a.module_allow_retries+'</span><input type="number" name="meta_retry_attempts" value="'+i.retry_attempts+'" min="0" class="small-text" /><span class="description">'+a.module_allow_retries_desc+"</span></label>"}function p(){return'<label class="module-minimum-grade"><span class="label">'+a.module_minimum_grade+'</span><input type="number" name="meta_minimum_grade" value="'+i.minimum_grade+'" min="0" max="100" class="small-text" /><span class="description">'+a.module_minimum_grade_desc+"</span></label>"}var r,i,t=_coursepress.unit_builder_module_types,a=_coursepress.unit_builder_module_labels;if(e.module_type()&&_coursepress.unit_builder_templates[e.module_type()].trim().length>0&&(i=JSON.parse(_coursepress.unit_builder_templates[e.module_type()])),void 0===i||void 0===_coursepress.unit_builder_module_types[i.type])return"";i.id=e.get("ID"),i.title=e.get("post_title"),i.duration=e.get_meta("duration"),i.type=e.module_type(),i.mode=t[i.type].mode,i.show_title=e.fix_boolean(e.get_meta("show_title")),i.mandatory=e.fix_boolean(e.get_meta("mandatory")),i.assessable=e.fix_boolean(e.get_meta("assessable")),i.minimum_grade=e.get_meta("minimum_grade",100),i.allow_retries=e.fix_boolean(e.get_meta("allow_retries")),i.retry_attempts=e.get_meta("retry_attempts",0),i.use_timer=e.fix_boolean(e.get_meta("use_timer")),i.instructor_assessable=e.fix_boolean(e.get_meta("instructor_assessable"));var n=e.get("post_excerpt");n=n&&n.length>0?n:e.get("post_content"),n=_.escape(n),i.content=n.trim(),i.order=e.get_meta("order",0),i.page=e.get_meta("page",1),i.moduletoautocorrect=_coursepress.modules_to_autocorrect,i.unit=e.get("post_parent"),r='<h3 class="module-holder-title '+i.type+'"><span class="label">'+i.title+'</span><span class="module-type">'+t[i.type].title+'</span></h3><div class="module-holder '+i.type+" mode-"+i.mode+'" data-id="'+i.id+'" data-type="'+i.type+'" data-order="'+s+'" data-cid="'+e.cid+'">';var o=i.type;if(t[i.type].body&&"hidden"!==t[i.type].body||!t[i.type].body){if(r+='<div class="module-header">',r+='<div class="module module-title"><h4 class="label">'+a.module_title+'</h4><span class="description">'+a.module_title_desc+'</span><label class="show-title"><input type="checkbox" class="show-title" name="meta_show_title['+e.cid+']" value="1" '+CoursePress.utility.checked(i.show_title,1)+' data-target=".module-title-text"/>'+a.module_show_title_desc+'</label><input class="module-title-text" type="text" name="post_title" value="'+i.title+'" /></div>',r+='<input type="hidden" name="meta_module_type" value="'+i.type+'" />',("input"===i.mode||"discussion"===i.type)&&(r+=u(),r+=l(),"input"===i.mode&&(null!=o.match(/input/)&&(r+=c()),r+=d(),r+=p())),"video"===i.type&&(r+=c(),r+=d()),r+='<div class="module module-duration"><h4 class="div">'+a.module_duration+'</h4><input type="text" name="meta_duration" value="'+i.duration+'" /></div>',"input-upload"===o&&(r+='<label class="module-assessable-2"><input type="checkbox" name="meta_instructor_assessable['+e.cid+']" value="1" '+CoursePress.utility.checked(i.instructor_assessable,1)+' /><span class="label">'+a.module_instructor_assessable+'</span><br /><span class="description">'+a.module_instructor_assessable_desc+"</span></label>"),t[i.type].excerpt&&"hidden"!==t[i.type].excerpt||!t[i.type].excerpt){var m="";
m=0===parseInt(i.id)||_.isNaN(parseInt(i.id))?"post_content_"+(new Date).getTime():"post_content_"+i.id+"_"+(new Date).getTime();var f=m,h="input"===i.mode?a.module_question:a.module_content,v="input"===i.mode?a.module_question_desc:a.module_content_desc,g=i.editor_height?'data-height="'+i.editor_height+'"':"";r+='<div class="module module-excerpt"><h4 class="label">'+h+'</h4><span class="description">'+v+'</span><textarea class="editor" name="'+m+'" id="'+f+'" '+g+">"+i.content+"</textarea></div>"}r+="</div>",r+='<div class="module module-components">'+CoursePress.Helpers.Module.render_components(e,i)+"</div>"}return r+='<div class="unit-buttons"><div class="button unit-delete-module-button"><i class="fa fa-trash-o"></i> '+a.module_delete+"</div></div>",r+="</div>"},CoursePress.Helpers.Module.render_components=function(s,t){var a="",r=_.isArray(t.components)?t.components:[],i={};return e.each(r,function(r,n){var o=n.label?n.label:"",u=n.description?n.description:"",l=n["class"]?'class="'+n["class"]+'"':"",c=r,d="module-component-"+c;a+='<div class="module module-component '+d+'"><label data-key="label" '+l+'><span class="label">'+o+'</span><span class="description">'+u+"</span></label>";var p=_.isArray(n.items)?n.items:[];e.each(p,function(r,n){var u,l,c,p,m,f,h,v,g,o=n.type?n.type:"";switch(o){case"text-input":case"number-input":var b=n.name.replace("meta_","");b=s.get_meta(b),u=n.name?' name="'+n.name+'"':"",u+=n["class"]?' class="'+n["class"]+'"':"",v=n.label?n.label:"";var C=n.label_tag?n.label_tag:"";f=n.placeholder?n.placeholder:"";var w="number-input"==o?"number":"text";v.length>1&&(a+="<"+C+">"+v+"</"+C+">"),a+='<input type="'+w+'"'+u+' value="'+b+'" placeholder="'+f+'" />';break;case"text":u=n["class"]?' class="'+n["class"]+'"':"",l=n.text?n.text:"",a+="<div"+u+">"+l+"</div>";break;case"select-select":case"radio-select":c=n.name?n.name:"",u=n["class"]?' class="'+n["class"]+'"':"",p=s.get_meta("answers"),p=p.length>0?p:n.answers,m=s.get_meta("answers_selected",parseInt(n.selected)),a+='<div class="answer-group">',e.each(p,function(e,t){_.isNaN(parseInt(m))&&(m=m===t?e:m),M=c+"_selected["+s.cid+"]",a+='<div class="answer"><input type="radio" name="'+M+'" value="'+e+'" '+CoursePress.utility.checked(parseInt(m),e)+" />",a+='<input type="text" '+u+' value="'+t+'" name="'+c+'[]" /> <span class="remove-item"></span><i class="fa fa-trash-o"></i></span></div>'}),a+="</div>",a+='<a class="add-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"checkbox-select":c=n.name?n.name:"",u=n["class"]?' class="'+n["class"]+'"':"",p=s.get_meta("answers"),p=p.length>0?p:n.answers,m=s.get_meta("answers_selected"),m=m.length>0?m:n.selected,_.isNaN(parseInt(m[0]))&&e.each(m,function(e,s){m[e]=_.indexOf(p,s)}),a+='<div class="answer-group">',e.each(p,function(e,t){var r=_.indexOf(m,e)>-1?'checked="checked"':"";M=c+"_selected["+s.cid+"][]",a+='<div class="answer"><input type="checkbox" name="'+M+'" value="'+e+'" '+r+" />",a+='<input type="text" '+u+' value="'+t+'" name="'+c+'[]" /> <span class="remove-item"><i class="fa fa-trash-o"></i></span></div>'}),a+="</div>",a+='<a class="add-item">'+_coursepress.unit_builder_add_answer_label+"</a>";break;case"media-caption-settings":h=n["class"]?' class="'+n["class"]+'"':"";var P=n.option_class?' class="'+n.option_class+'"':"",y=n.label?n.label:"",k=n.option_labels?n.option_labels.media:"",x=n.option_labels?n.option_labels.custom:"";f=n.placeholder?n.placeholder:"";var q=n.enable_name?n.enable_name:"",M=n.option_name?n.option_name:"",V=n.input_name?n.input_name:"",U=n.no_caption?n.no_caption:"",z=s.get_meta(q),E=s.get_meta(M),I=s.get_meta(V);q=q+"["+s.cid+"]",M=M+"["+s.cid+"]",a+="<div "+h+'><label><input type="checkbox" value="1" name="'+q+'" '+CoursePress.utility.checked(z,1)+" /><span>"+y+"</span></label><div "+P+'><label><input type="radio" value="media" name="'+M+'" '+CoursePress.utility.checked(E,"media")+" /><span>"+k+'</span></label><div class="existing">'+U+'</div><label><input type="radio" value="custom" name="'+M+'" '+CoursePress.utility.checked(E,"custom")+" /><span>"+x+'</span></label><br /><input type="text" placeholder="'+f+'" value="'+I+'" name="'+V+'" /></div></div>',i.media_url&&i.media_url.length>0&&(CoursePress.utility.attachment_by_url(i.media_url,"."+d+" .existing",U),i.media_url=null);break;case"media-browser":var B=n.media_type?n.media_type:"image",H=n["class"]?n["class"]:"";h=n.container_class?n.container_class:"";var T=n.button_text?n.button_text:"";f=n.placeholder?n.placeholder:"",c=n.name?n.name:"",g=s.get_meta(c,""),a+=CoursePress.UI.browse_media_field(c,c,{value:g,type:B,container_class:h,textbox_class:H,placeholder:f,button_text:T}),i.media_url=g;break;case"checkbox":c=n.name?n.name:"",v=n.label?n.label:"",g=s.get_meta(c,""),c=c+"["+s.cid+"]",a+='<label class="normal"><input type="checkbox" value="1" name="'+c+'" '+CoursePress.utility.checked(g,1)+" /><span>"+v+"</span></label>";break;case"action":var A=n["class"]||"",D=n.action||"",S=n.title||"",j=n.dashicon||"";a+='<div class="'+A+'" data-type="'+D+'"><a>',j&&(a+='<span class="dashicons dashicons-'+j+'"></span>'),a+="</a>",S&&(a+='<span class="element-label">'+S+"</span>"),a+="</div>";break;case"quiz":a+=CoursePress.Helpers.Module.quiz.render_component(s);break;case"form":a+=CoursePress.Helpers.Module.form.render_component(s);break;case"autocor-select":u=n.name?' name="'+n.name+'"':"",u+=n["class"]?' class="'+n["class"]+'"':"",p=t.moduletoautocorrect,p=p.length>0?p:"",question_selected=s.get_meta("question_selected"),question_selected=parseInt(question_selected),a+="<select "+u+">",e.each(p,function(e,s){t.unit===s.post_parent&&(m=question_selected===s.ID?"selected":"",a+='<option value="'+s.ID+'"'+m+">"+s.post_title+"</option>")}),a+="</select >"}}),a+="</div>"}),a},CoursePress.Views.UnitBuilder=Backbone.View.extend({initialize:function(){this.unit_collection=new CoursePress.Collections.UnitTabs,this.unit_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=units&course_id="+_coursepress.course_id,this.unit_collection.fetch(),this.module_collection=new CoursePress.Collections.UnitModules,this.tabViewCollection=new CoursePress.Views.UnitTabViewCollection({model:this.unit_collection,tagName:"ul",className:"sticky-tabs"}),this.tabViewCollection.parentView=this,this.headerView=new CoursePress.Views.UnitBuilderHeader,this.headerView.parentView=this,this.contentView=new CoursePress.Views.UnitBuilderBody({model:this.module_collection,className:"unit-builder-body"}),this.contentView.parentView=this,this.activePage=1,this.totalPages=1,this.activeUnitStatus="draft",this.activeModuleRef="",this.render()},events:{"click .unit-save-button":"saveUnit","change #unit-live-toggle":"toggleUnitState","change #unit-live-toggle-2":"toggleUnitState","click .unit-delete-module-button":"deleteModule","click .unit-delete-page-button":"deletePage","click .unit-delete-button":"deleteUnit","click .button-add-new-unit":"newUnit","click .unit-builder-tabs ul.sticky-tabs li":"changeActive","click .button-preview":"toPreview"},render:function(){var s=_.template(e("#unit-builder-template").html());return this.$el.html(s),this.$(".unit-builder-tabs .sticky-wrapper .tabs").replaceWith(this.tabViewCollection.el),this.$(".unit-builder-header").append(this.headerView.el),this.$(".unit-builder-body").replaceWith(this.contentView.el),e(".sticky-wrapper-tabs").sticky({topSpacing:45}),this},fetchModules:function(e,s){this.module_collection.url=_coursepress._ajax_url+"?action=unit_builder&task=modules&course_id="+_coursepress.course_id+"&unit_id="+e+"&page="+s,this.module_collection.fetch({success:function(){this.$(".unit-save-button").removeClass("disabled")}});var t=this.unit_collection._byId[this.activeUnitRef].get("meta");this.totalPages=t.page_title?t.page_title.length:1,this.totalPages=void 0===this.totalPages?_.size(t.page_title):1,this.activeModuleRef=""},userCap:function(e){var s=this.unit_collection._byId[this.activeUnitRef].get("user_cap");return s[e]},saveUnit:function(s){e(s.target).hasClass("disabled")||CoursePress.Helpers.Module.save_unit(s)},toggleUnitState:function(e){CoursePress.Helpers.Module.toggle_unit_state(e)},deleteModule:function(s){if(window.confirm(_coursepress.unit_builder_delete_module_confirm)){var t=s.currentTarget,a=e(t).parents(".module-holder")[0],r=e(a).attr("data-cid");this.module_collection.remove(r),e(a).parents(".group").detach()}},deletePage:function(e){var s=this;if(window.confirm(_coursepress.unit_builder_delete_page_confirm)){var t=parseInt(this.activePage);CoursePress.Helpers.Module.delete_page(e,s.activeUnitID,t),location.reload()}},deleteUnit:function(s){if(window.confirm(_coursepress.unit_builder_delete_unit_confirm)){this.unit_collection.remove(this.activeUnitRef),e('ul li[data-tab="'+this.activeUnitID+'"]').detach(),e(e(".unit-builder-body")[0]).empty(),e('.unit-detail input[type="text"]').val(""),e('.unit-detail input[type="checkbox"]').removeAttr("checked"),e("#unit-live-toggle").removeClass("on").addClass("off"),e("#unit-live-toggle-2").removeClass("on").addClass("off"),e(e('li[data-tab="units"] a')[0]).html(e(e('li[data-tab="units"] a')[0]).html().replace(/\d+/,e(".unit-builder-tabs ul li").length)),CoursePress.Helpers.Module.save_unit(s);var t=this.tabViewCollection.$el.find("li").last();t&&t.length>0&&t.trigger("click",t)}},newUnit:function(s){this.is_add=!0;var t=this,a=e(".unit-builder-tabs .sticky-tabs li").length,r=new CoursePress.Models.Unit;r.set_meta("unit_order",a+1),r.set_meta("page_title",{page_1:""}),r.set_meta("show_page_title",[!0]),r.set("post_title",_coursepress.unit_builder_new_unit_title),t.unit_collection.add(r),CoursePress.Helpers.Module.save_unit(s,"new_success");var i=new CoursePress.Views.UnitTabView({model:r,tagName:"li"}),n=i.render().$el;e(".button-add-new-unit .fa").removeClass("fa-plus-square").addClass("fa-spinner").addClass("fa-spin"),t.unit_collection.on("new_success",function(){t.unit_collection.fetch({success:function(){e(".button-add-new-unit .fa").removeClass("fa-spin").removeClass("fa-spinner").addClass("fa-plus-square"),e(".unit-builder-tabs ul.sticky-tabs").append(n),CoursePress.Helpers.Module.refresh_ui(),e(e('li[data-tab="units"] a')[0]).html(e(e('li[data-tab="units"] a')[0]).html().replace(/\d+/,e(".unit-builder-tabs ul li").length))}}),t.unit_collection.off("new_success")})},changeActive:function(s){e("#unit-builder .tab-tabs li").removeClass("active"),e(s.currentTarget).addClass("active");var t=e(s.currentTarget).attr("data-tab"),a=this;this.unit_collection.each(function(e){parseInt(t)===parseInt(e.get("ID"))&&CoursePress.Helpers.changeUnit(e,a)})},toPreview:function(s){var t=e(s.currentTarget),a=t.data("href");t.attr("href",a+this.activeUnitID)}}),CoursePress.Models.Unit=Backbone.Model.extend({initialize:function(){this.url=_coursepress._ajax_url+"?action=unit_builder&task=unit_update&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID,this.on("change",this.process_changed,this),this.on("sync",this.model_saved,this)},set_meta:function(e,s){e=e.replace("meta_","");var t=this.get("meta")||{};t[e]=s,this.set("flag","dirty"),this.set("meta",t),this.trigger("change",this)},set_page_title:function(e,s){var t=this.get("meta")||{};t.page_title=t.page_title||{},t.page_title["page_"+e]=s,this.set("meta",t),this.trigger("change",this)},set_page_description:function(e,s){var t=this.get("meta")||{};s=_.escape(s),t.page_description=t.page_description||{},t.page_description["page_"+e]=s,this.set("meta",t),this.trigger("change",this)},set_page_image:function(e,s){var t=this.get("meta")||{};t.page_feature_image=t.page_feature_image||{},t.page_feature_image["page_"+e]=s,this.set("meta",t),this.trigger("change",this)},set_page_visibility:function(e,s){var t=this.get("meta")||{},a=e-1;t.show_page_title&&(t.show_page_title[a]=s,this.set("meta",t),this.trigger("change",this))},get_page_title:function(e){var s=this.get("meta")||{};return s.page_title?s.page_title["page_"+e]:""},get_page_description:function(e){var s=this.get("meta")||{};return s.page_description?s.page_description["page_"+e]:""},get_page_image:function(e){var s=this.get("meta")||{};return s.page_feature_image?s.page_feature_image["page_"+e]:""},get_page_visibility:function(e){var s=this.get("meta")||{};return s.show_page_title?s.show_page_title[e-1]:!0},process_changed:function(){this.set("flag","dirty")},model_saved:function(){}}),CoursePress.Models.Module=Backbone.Model.extend({initialize:function(){var s=e("#unit-builder").attr("data-nonce");this.url=_coursepress._ajax_url+"?action=unit_builder&task=module_add&course_id="+_coursepress.course_id+"&unit_id="+CoursePress.UnitBuilder.activeUnitID+"&wp_nonce="+s,this.on("change",this.process_changed,this),this.on("sync",this.model_saved,this)},get_meta:function(e,s){e=e.replace("meta_",""),void 0===s&&(s="");var t=this.get("meta")||{},a=t[e]?t[e]:s,r=_.isString(a)?a.toLowerCase():a;return("yes"===r||"on"===r||"no"===r||"off"===r)&&(a=this.fix_boolean(a)),t.legacy_updated||0!==a.length&&a!==!1&&0!==a||(a=this.get_legacy_meta(e,s)),a},get_legacy_meta:function(e,s){var t,a;switch(e){case"duration":e="time_estimation";break;case"show_title":e="show_title_on_front";break;case"mandatory":e="mandatory_answer";break;case"assessable":e="gradable_answer";break;case"minimum_grade":e="minimum_grade_required";break;case"allow_retries":return t=this.get("meta"),t.limit_attempts?(a=t.limit_attempts[0],!this.fix_boolean(a)):s;case"retry_attempts":e="limit_attempts_value";break;case"order":e="module_order";break;case"page":e="module_page";break;case"answers_selected":e="input-radio"===this.module_type()?"checked_answer":"checked_answers"}return t=this.get("meta")||{},a=t[e]?t[e]:s},fix_legacy_module:function(e){var s=this,t=s.get("meta");if(s.set("flag","dirty"),t.module_type=e,t.checked_answer&&(t.answers_selected=t.checked_answer),t.checked_answers&&(t.answers_selected=t.checked_answers),t.time_estimation&&(t.duration=t.time_estimation),t.show_title_on_front&&(t.show_title=s.fix_boolean(t.show_title_on_front)),t.mandatory_answer&&(t.mandatory=s.fix_boolean(t.mandatory_answer)),t.gradable_answer&&(t.assessable=s.fix_boolean(t.gradable_answer)),t.minimum_grade_required&&(t.minimum_grade=t.minimum_grade_required),t.limit_attempts){var a=s.fix_boolean(t.limit_attempts);t.allow_retries=!a}t.limit_attempts_value&&(t.retry_attempts=t.limit_attempts_value),s.set("meta",t)},map_legacy_type:function(e){var s=this,t={audio_module:"audio",chat_module:"chat",checkbox_input_module:"input-checkbox",file_module:"download",file_input_module:"input-upload",image_module:"image",radio_input_module:"input-radio",page_break_module:"section",section_break_module:"section",text_module:"text",text_input_module:"input-text",textarea_input_module:"input-textarea",video_module:"video"};return e in t&&(e="single"!==this.get_meta("checked_length","single")?"input-textarea":t[e],s.fix_legacy_module(e)),e},module_type:function(){return this.map_legacy_type(this.get_meta("module_type"))},fix_boolean:function(e){var s=_.isString(e)?e.toLowerCase():e;return 1===parseInt(s)||"on"===s||"yes"===s||!0===s},set_meta:function(e,s){e=e.replace("meta_","");var t=this.get("meta")||{};t[e]=s,this.set("flag","dirty"),this.set("meta",t),this.trigger("change",this)},from_template:function(s){var t=JSON.parse(_coursepress.unit_builder_templates[s]);this.set("ID",t.id),this.set("post_title",t.title),this.set_meta("duration",t.duration||"1:00"),this.set_meta("module_type",t.type),this.set_meta("mandatory",t.mandatory),this.set_meta("show_title",t.show_title||!0),this.set_meta("assessable",t.assessable),this.set_meta("minimum_grade",t.minimum_grade),this.set_meta("allow_retries",t.allow_retries),this.set_meta("retry_attempts",t.retry_attempts),"input-quiz"===t.type&&this.set_meta("use_timer",t.use_timer),"input-form"===t.type&&this.set_meta("use_timer",t.use_timer),this.set("post_content",t.content||""),this.set_meta("order",t.order);var a=this;e.each(t.components,function(s,t){e.each(t.items,function(e,s){a.item_to_meta(s)})})},item_to_meta:function(e){var s=this;switch(e.type){case"media-browser":case"text-input":s.set_meta(e.name,"");break;case"checkbox-select":case"select-select":case"radio-select":s.set_meta(e.name,e.answers),s.set_meta(e.name+"_selected",e.selected);break;case"media-caption-settings":s.set_meta(e.enable_name,!1),s.set_meta(e.option_name,"media"),s.set_meta(e.input_name,"");break;case"checkbox":s.set_meta(e.name,!1)}},model_saved:function(e){CoursePress.UnitBuilder.activeModuleRef=e.cid,CoursePress.UnitBuilder.gotoAdded=!0},process_changed:function(){CoursePress.UnitBuilder.activeModuleRef=this.cid,this.set("flag","dirty")}}),CoursePress.Collections.UnitTabs=Backbone.Collection.extend({model:CoursePress.Models.Unit}),CoursePress.Collections.UnitModules=Backbone.Collection.extend({model:CoursePress.Models.Module}),CoursePress.Views.UnitTabView=Backbone.View.extend({render:function(){var s=this.model.get("post_status"),t=this.model.get("meta"),a={unit_id:this.model.get("ID"),unit_title:this.model.get("post_title"),unit_live_class:"publish"===s?"unit-live":"unit-draft",unit_active_class:this.first?"active":"",unit_order:t.unit_order,unit_cid:this.model.cid},r=_.template(e("#unit-builder-tab-template").html());return this.$el=r(a),this}}),CoursePress.Views.UnitTabViewCollection=Backbone.View.extend({initialize:function(){this.model.on("sync",this.render,this)},events:{},render:function(){var e=this;e.$el.empty();var s=0,t=this.model.length;return this.parentView.is_add&&(s=t-1),this.model.each(function(t,a){var r=new CoursePress.Views.UnitTabView({model:t,tagName:"li"});r.first=s===a,e.$el.append(r.render().$el),s===a?CoursePress.Helpers.changeUnit(t,e):(e.parentView.contentView.initial=!0,e.parentView.contentView.render())}),this.model.trigger("rendered",this.model),this},changeActive:function(s){e("#unit-builder .tab-tabs li").removeClass("active"),e(s.currentTarget).addClass("active");var t=e(s.currentTarget).attr("data-tab"),a=this;this.model.each(function(s){parseInt(t)===parseInt(s.get("ID"))&&(CoursePress.Helpers.changeUnit(s,a),e("body,html").animate({scrollTop:e(".section.unit-builder-header").offset().top-20,duration:200}))})}}),CoursePress.Helpers.changeUnit=function(e,s,t){s=CoursePress.UnitBuilder,void 0===t&&(t=1),s.activePage=t,s.headerView.template_variables.unit_id=e.get("ID"),s.headerView.template_variables.unit_cid=e.cid,s.headerView.template_variables.unit_title=e.get("post_title"),s.headerView.template_variables.unit_content=e.get("post_content");var a=e.get("meta");s.headerView.template_variables.unit_availability=a.unit_availability,s.headerView.template_variables.unit_date_availability=a.unit_date_availability?a.unit_date_availability:"",s.headerView.template_variables.unit_delay_days=a.unit_delay_days?a.unit_delay_days:0,s.headerView.template_variables.unit_feature_image=a.unit_feature_image;var r=a.force_current_unit_completion;r="on"===r||!0===r||1===parseInt(r)?'checked="checked"':"",s.headerView.template_variables.unit_force_completion_checked=r,r=a.force_current_unit_successful_completion,r="on"===r||!0===r||1===parseInt(r)?'checked="checked"':"",s.headerView.template_variables.unit_force_successful_completion_checked=r,s.headerView.render(),s.headerView.$el.find('[name="meta_unit_availability"]').trigger("change",s.headerView),s.contentView.initial=!0,s.contentView.render(),s.activeUnitID=e.get("ID"),s.activeUnitRef=e.cid,s.activeUnitStatus=e.get("post_status"),s.fetchModules(s.activeUnitID,s.activePage);var i=e.get("user_cap"),n=s.$el.find(".unit-builder-no-access");i.coursepress_update_course_unit_cap?(s.headerView.$el.show(),s.contentView.$el.show(),n.hide()):(s.headerView.$el.hide(),s.contentView.$el.hide(),n.show())},CoursePress.Views.UnitBuilderHeader=Backbone.View.extend({initialize:function(){this.template_variables={unit_id:"",unit_cid:"",unit_title:"",unit_content:"",unit_feature_image:"",unit_availability:"",unit_date_availability:"",unit_delay_days:0,unit_force_completion_checked:"",unit_force_successful_completion_checked:""},this.render(),CoursePress.Events.on("editor:keyup",this.editorChanged,this)},events:{"change .unit-detail input":"fieldChanged","keyup .unit-detail input[name=post_title]":"updateTabTitle","keyup .unit-detail .wp-unit-editor":"editorChanged","change #unit-live-toggle":"toggleUnitState","change #unit-live-toggle-2":"toggleUnitState","change #unit_feature_image":"unitFeatureImageChange",'change [name="unit_feature_image-button"]':"unitFeatureImageChange",'change [name="meta_unit_availability"]':"toggleAvailability",'focus [name="meta_unit_date_availability"]':"setDate","change select":"fieldChanged"},render:function(){var s=this.template_variables;0===parseInt(s.unit_delay_days)&&(s.unit_delay_days="");var t=_.template(e("#unit-builder-header-template").html());return this.$el.html(t(s)),e("#unit_feature_image").val(s.unit_feature_image),this.updateUnitHeader(),this},editorChanged:function(s){var t=s.id,a=/^unit_description_\d+$/;if(void 0===t&&(t=e(s.currentTarget).attr("id")),void 0!==t&&a.test(t)){var r=e("#"+t),i=CoursePress.editor.content(t),n=e(r).parents(".unit-detail")[0],o=this.parentView.unit_collection._byId[e(n).attr("data-cid")];i=_.escape(i),o.set("post_content",i)}},fieldChanged:function(s){var t=e(s.currentTarget),a=e(t).attr("name");if("unit_feature_image"!==a&&"unit_feature_image-button"!==a&&"page_feature_image"!==a&&"page_feature_image-button"!==a){var r=e(t).val(),i=e(t).parents(".unit-detail")[0],n=this.parentView.unit_collection._byId[e(i).attr("data-cid")],o=e(t).attr("type");"checkbox"===o&&(r=e(t).is(":checked")),n&&(/meta_/.test(a)?n.set_meta(a,r):n.set(a,r))}},unitFeatureImageChange:function(s){var t=e(s.currentTarget),a=e("#unit_feature_image").val(),r=t.parents(".unit-detail").first(),i=this.parentView.unit_collection._byId[r.attr("data-cid")];i.set_meta("unit_feature_image",a)},updateTabTitle:function(s){e('[data-tab="'+this.parentView.activeUnitID+'"] span').html(e(s.currentTarget).val())},toggleUnitState:function(e){CoursePress.Helpers.Module.toggle_unit_state(e)},updateUnitHeader:function(){e.each(e(".unit-wp-editor"),function(s,t){var a=e(t).attr("id");tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a);var r=e("#"+a).val(),i=e(t).attr("name"),n=e(t).attr("data-height")?e(t).attr("data-height"):200;CoursePress.editor.create(t,a,i,r,!1,n)})},toggleAvailability:function(s){var t=e(s.currentTarget),a=t.val(),r=t.parent().find(".ua-div"),i=t.parent().find(".div-"+a);r.hide(),i.length>0&&i.show()},setDate:function(s){var t=e(s.target);t.datepicker()}}),CoursePress.Views.UnitBuilderFooter=Backbone.View.extend({render:function(){var s=_.template(e("#unit-builder-footer-template").html());return this.$el.empty(),this.$el.html(s),this}}),CoursePress.Views.UnitBuilderBody=Backbone.View.extend({initialize:function(){this.initial=!0,this.pagerView=new CoursePress.Views.UnitBuilderPager({className:"section unit-builder-pager"}),this.pagerView.parentView=this,this.pagerView.template_variables={},this.pagerViewInfo=new CoursePress.Views.UnitBuilderPagerInfo({className:"section unit-builder-pager-info"}),this.pagerViewInfo.parentView=this,this.pagerViewInfo.template_variables={},this.componentsView=new CoursePress.Views.UnitBuilderComponents({className:"section unit-builder-components"}),this.componentsView.parentView=this,this.componentsView.template_variables={},this.modulesView=new CoursePress.Views.UnitBuilderModules({className:"section unit-builder-modules"}),this.modulesView.parentView=this,this.modulesView.template_variables={},this.footerView=new CoursePress.Views.UnitBuilderFooter({className:"unit-buttons"}),this.footerView.parentView=this,this.model.on("sync",this.render,this),CoursePress.Events.on("editor:keyup",this.editorChanged,this)},render:function(){var s;if(this.initial)s=_.template(e("#unit-builder-content-placeholder").html()),this.$el.html(s),this.initial=!1;else{s=_.template(e("#unit-builder-content-template").html()),this.$el.html(s);var t=this.parentView.unit_collection._byId[this.parentView.activeUnitRef];this.pagerView.template_variables.unit_page_count=this.parentView.totalPages,this.pagerView.template_variables.pages_titles=t.attributes.meta.page_title,this.$(".unit-builder-pager").replaceWith(this.pagerView.render(this.pagerView.template_variables).el),t=this.parentView.unit_collection._byId[this.parentView.activeUnitRef];var a=t.get_page_visibility(this.parentView.activePage);if(a=a||!1===a?_.isString(a)&&("yes"===a.toLowerCase()||"on"===a.toLowerCase())||1===parseInt(a)||!0===a:!0,this.pagerViewInfo.template_variables={page_label_text:t.get_page_title(this.parentView.activePage),page_description:t.get_page_description(this.parentView.activePage),page_feature_image:t.get_page_image(this.parentView.activePage),page_label_checked:a?'checked="checked"':""},this.$(".unit-builder-pager-info").replaceWith(this.pagerViewInfo.render(this.pagerViewInfo.template_variables).el),this.componentsView.template_variables={},this.$(".unit-builder-components").replaceWith(this.componentsView.render(this.componentsView.template_variables).el),this.$(".unit-builder-modules").replaceWith(this.modulesView.render(this.parentView.module_collection.models).el),this.$(".unit-builder-footer").append(this.footerView.render().el),this.$(".unit-save-button").removeClass("disabled"),CoursePress.Helpers.Module.refresh_ui(),this.updateSectionEditor(),e("#page_feature_image").val(this.pagerViewInfo.template_variables.page_feature_image),CoursePress.UnitBuilder.gotoAdded===!0){CoursePress.UnitBuilder.gotoAdded=!1;var r=e("[data-cid="+CoursePress.UnitBuilder.activeModuleRef+"]");e("body,html").scrollTop(e(r).offset().top-80)}}return e(".page-info-holder input[name=page_title]").on("keyup",function(){label=e(this).val(),label=label.length>19?label.substr(0,19)+"":label,e(".unit-builder-pager li.active").html(label)}),this},events:{"click .unit-builder-components .output-element":"add_element","click .unit-builder-components .input-element":"add_element","change .button.browse-media-field":"fieldChanged","change .module-holder input":"fieldChanged","change textarea":"fieldChanged","change select":"selectionChanged","change .page-info-holder input":"unitPageInfoChanged","keyup .module-title-text":"updateUIHeading","click .unit-builder-pager ul li":"changePage","click .module-component .add-item":"addAnswer","click .module-component .remove-item":"removeAnswer","change #page_feature_image":"pageFeatureImageChange",'change [name="page_feature_image-button"]':"pageFeatureImageChange"},pageFeatureImageChange:function(s){var t=e(s.currentTarget),a=e("#page_feature_image").val(),r=this.parentView.activePage,i=e(e(t).parents(".unit-builder-content")[0]).find(".unit-detail")[0],n=this.parentView.unit_collection._byId[e(i).attr("data-cid")];n.set_page_image(r,a)},add_element:function(s){CoursePress.Helpers.Module.unit_add_show_message('<i class="fa fa-circle-o-notch fa-spin"></i> '+_coursepress.unit_builder_form.messages.adding_module,"info");var t=s.currentTarget,a=e(t).attr("class").match(/module-(\w|-)*/g)[0].trim().replace("module-",""),r=e(".module-holder").length,i=new CoursePress.Models.Module;i.from_template(a),i.set_meta("module_order",r+1),i.set_meta("module_page",this.parentView.activePage),i.save(null,{success:function(){e(".section.unit-builder-components .notice").detach()}}),this.parentView.module_collection.add(i)},fieldChanged:function(s){var t=e(s.currentTarget),a=e(t).attr("name");if("unit_feature_image"!==a&&"unit_feature_image-button"!==a&&"page_feature_image"!==a&&"page_feature_image-button"!==a){var u,r=e(t).val(),i=e(t).parents(".module-holder")[0],n=this.parentView.module_collection._byId[e(i).attr("data-cid")],o=e(t).attr("type");if("checkbox"===o&&(u=e('[name="'+a+'"]'),a=a.replace(/\[.*\]/,""),u.length>1?(r=[],e.each(u,function(s,t){e(t).is(":checked")&&r.push(s)})):r=e(t).is(":checked")),"radio"===o&&(a=a.replace(/\[.*\]/,"")),("text"===o||"textbox"===o)&&/\[\]/.test(a)){var l=e(t).parents(".module-component");if(l.length>0)return u=e(l).find('[name="'+a+'"]'),a=a.replace(/\[.*\]/,""),r=[],e.each(u,function(s,t){r.push(e(t).val())}),void n.set_meta(a,r)}if("button"===o&&e(t).hasClass("browse-media-field")){var c=e(e(t)[0]).siblings("[type=text]")[0];a=e(c).attr("name"),r=e(c).val()}/meta_/.test(a)?n.set_meta(a,r):n.set(a,r)}},selectionChanged:function(s){var t=e(s.currentTarget),a=e(t).attr("name"),r=e(t).val(),i=e(t).parents(".module-holder")[0],n=this.parentView.module_collection._byId[e(i).attr("data-cid")];/meta_/.test(a)?n.set_meta(a,r):n.set(a,r)},editorChanged:function(s){var t=s.id,a=e("#"+t).parents(".module-holder")[0];if(void 0!==a){var r=this.parentView.module_collection._byId[e(a).attr("data-cid")],i=/post_content_/.test(t)?t.replace(/(_\d+)+$/,""):t,n=CoursePress.editor.content(t);/meta_/.test(i)?r.set_meta(i,n):r.set(i,n)}},updateUIHeading:function(s){var t=e(s.currentTarget),a=e(t.parents(".module-holder").first()).siblings("h3").first();e(a).find(".label").html(t.val())},changePage:function(s){var t=this,a=e(s.currentTarget).attr("data-page"),r=t.parentView.unit_collection._byId[t.parentView.activeUnitRef];a?(t.parentView.activePage=e(s.currentTarget).attr("data-page"),t.parentView.fetchModules(t.parentView.activeUnitID,t.parentView.activePage)):(t.parentView.activePage=e(".unit-builder-pager ul li").length,t.parentView.totalPages=t.parentView.activePage,r.set_page_title(t.parentView.activePage,""),r.set_page_visibility(t.parentView.activePage,!0),t.parentView.fetchModules(t.parentView.activeUnitID,t.parentView.activePage))},unitPageInfoChanged:function(s){var t=e(s.currentTarget),a=e(t).attr("name"),r=e(t).val(),i=this.parentView.unit_collection._byId[this.parentView.activeUnitRef],n=e(t).attr("type");switch("checkbox"===n&&(r=e(t).is(":checked")),a){case"page_title":i.set_page_title(this.parentView.activePage,r);break;case"show_page_title":i.set_page_visibility(this.parentView.activePage,r)}i.trigger("change",i)},addAnswer:function(s){var t=s.currentTarget,a=e(t).siblings(".answer-group"),r=e(t).parents(".module-holder"),i=e(r).attr("data-cid"),n=e(r).find(".answer"),o=n.length,u=e(e(t).parents(".module-holder")[0]).attr("class").match(/input-radio|input-select/)?"radio":"checkbox",l=e(e(t).parents(".module-holder")[0]).attr("class").match(/input-radio|input-select/)?"meta_answers_selected["+i+"]":"meta_answers_selected["+i+"][]";e(a).append('<div class="answer"><input type="'+u+'" value="'+o+'" name="'+l+'"><input class="component-'+u+'-answer wide" type="text" name="meta_answers[]" value=""> <span class="remove-item"><i class="fa fa-trash-o"></i></span></div>')},removeAnswer:function(s){var t=s.currentTarget,a=e(t).parents(".answer-group"),r=e(t).parents(".answer"),i=e(t).parents(".module-holder"),n=e(i).attr("data-cid"),o=this.parentView.module_collection._byId[n];r.detach();var u=e(a).find('[name="meta_answers_selected['+n+'][]"]'),l=[];e.each(u,function(s,t){e(t).is(":checked")&&l.push(s),e(t).val(s)}),o.set_meta("meta_answers_selected",l),u=e(a).find('[name="meta_answers[]"]'),l=[],e.each(u,function(s,t){l.push(e(t).val())}),o.set_meta("meta_answers",l)},updateSectionEditor:function(){e.each(e(".page-wp-editor"),function(s,t){var a=e(t).attr("id");tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a);var r=e("#"+a).val(),i=e(t).attr("name"),n=e(t).attr("data-height")?e(t).attr("data-height"):200;CoursePress.editor.create(t,a,i,r,!1,n)})}}),CoursePress.Views.UnitBuilderPager=Backbone.View.extend({render:function(s){var t=_.template(e("#unit-builder-pager-template").html());return this.$el.html(t(s)),this}}),CoursePress.Views.UnitBuilderPagerInfo=Backbone.View.extend({initialize:function(){CoursePress.Events.on("editor:keyup",this.editorChanged,this)},events:{"change .page-info-holder input":"fieldChanged","keyup .unit-detail .page-wp-editor":"editorChanged"},render:function(s){var t=_.template(e("#unit-builder-pager-info-template").html());
return s.page_id=Math.floor(1e10*Math.random()),this.$el.html(t(s)),this},editorChanged:function(s){var t=this.parentView.parentView.activePage,a=s.id,r=/^page_description_\d+$/;if(void 0===a&&(a=e(s.currentTarget).attr("id")),void 0!==a&&r.test(a)){var i=e("#"+a),n=CoursePress.editor.content(a),o=e(e(i).parents(".unit-builder-content")[0]).find(".unit-detail")[0],u=this.parentView.parentView.unit_collection._byId[e(o).attr("data-cid")];u.set_page_description(t,n)}}}),CoursePress.Views.UnitBuilderComponents=Backbone.View.extend({render:function(s){var t=_.template(e("#unit-builder-components-template").html());return this.$el.html(t(s)),this}}),CoursePress.Views.UnitBuilderModules=Backbone.View.extend({render:function(){var e=this;return e.$el.empty(),this.parentView.model.each(function(s){var t=new CoursePress.Views.ModuleView({model:s,tagName:"div",className:"group group-"+s.module_type()}),a=s.get_meta("module_order");e.$el.append(t.render(s,a).$el)}),this}}),CoursePress.Views.ModuleView=Backbone.View.extend({render:function(e,s){var t=this;return t.$el.empty(),t.$el.append(CoursePress.Helpers.Module.render_module(e,s)),CoursePress.Helpers.Module.refresh_ui(),this}}),e(document).ready(s)}(jQuery);